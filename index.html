<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="XinJie&#39;s Notes">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="XinJie&#39;s Notes">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XinJie&#39;s Notes">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>XinJie's Notes</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">XinJie's Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">life is too short to play it safe</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/23/1. What are algorithms and data structures?/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/23/1. What are algorithms and data structures?/" itemprop="url">1. What are algorithms and data structures?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-23T22:23:00+08:00">
                2018-01-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-What-are-algorithms-and-data-structures"><a href="#1-What-are-algorithms-and-data-structures" class="headerlink" title="1. What are algorithms and data structures?"></a><strong>1. What are algorithms and data structures?</strong></h1><h3 id="What-are-algorithms"><a href="#What-are-algorithms" class="headerlink" title="What are algorithms?"></a><strong>What are algorithms?</strong></h3><ul>
<li>An algorithm is a <strong>recipe</strong> for making the computer do something. </li>
<li>The recipe consists of a series of steps that you perform one after the other. An algorithm is just like that, except that it contains instructions for a computer to perform, not for a cook.</li>
<li>The ingredients – flour, milk, eggs, butter – are the <strong>data</strong> that the algorithm works on</li>
</ul>
<h3 id="What-are-the-data-structures"><a href="#What-are-the-data-structures" class="headerlink" title="What are the data structures?"></a><strong>What are the data structures?</strong></h3><ul>
<li>They are the <strong>containers</strong> that hold the data while the algorithm works on it.</li>
<li>In the pancake recipe, the data structures are the <strong>bag</strong> that holds the flour, the mixing <strong>bowl</strong> where you combine everything, and finally the <strong>plate</strong> used to serve the finished pancake.</li>
</ul>
<h3 id="Why-learn-algorithms-and-data-structures"><a href="#Why-learn-algorithms-and-data-structures" class="headerlink" title="Why learn algorithms and data structures?"></a><strong>Why learn algorithms and data structures?</strong></h3><ul>
<li>How often do you actually have to use a linked list or write your own sort routine when you’re making apps?  The answer is: <strong>almost never</strong>.</li>
</ul>
<p><strong>However…</strong> </p>
<ul>
<li>It gives you <strong>ideas for improvements</strong> you can make to your own code.</li>
<li>Knowing more data structures than just the standard array and dictionary gives you a bigger <strong>collection of tools</strong> you can use to build your own apps.</li>
<li>It will make you a better developer and <strong>make more $$$</strong>.</li>
</ul>
<h3 id="Don’t-spend-any-time-memorizing-algorithms"><a href="#Don’t-spend-any-time-memorizing-algorithms" class="headerlink" title="Don’t spend any time memorizing algorithms"></a><strong>Don’t spend any time memorizing algorithms</strong></h3><ul>
<li>Instead, try to understand how <strong>different</strong> algorithms approach different problems.</li>
<li>See what makes one approach slow and another fast, and learn what the <strong>tradeoffs</strong> are.</li>
<li>The <strong>key thing</strong> here is: to get insight in how we can make computers do things.</li>
</ul>
<h3 id="It’s-not-as-scary-as-it-sounds"><a href="#It’s-not-as-scary-as-it-sounds" class="headerlink" title="It’s not as scary as it sounds"></a><strong>It’s not as scary as it sounds</strong></h3><ul>
<li>If you can write code, you can also understand all these fancy algorithms and data structures.</li>
<li>Trust me, algorithms are fun. :-)</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/23/2. A note on Big-O notation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/23/2. A note on Big-O notation/" itemprop="url">2. A note on Big-O notation</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-23T22:23:00+08:00">
                2018-01-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="2-A-note-on-Big-O-notation"><a href="#2-A-note-on-Big-O-notation" class="headerlink" title="2. A note on Big-O notation"></a><strong>2. A note on Big-O notation</strong></h1><h3 id="What-is-Big-O-notation"><a href="#What-is-Big-O-notation" class="headerlink" title="What is Big-O notation"></a>What is Big-O notation</h3><ul>
<li>It’s useful to know <strong>how fast</strong> an algorithm is and <strong>how much space</strong> it needs.</li>
<li>Big-O notation gives you a rough indication of the <strong>running time</strong> of an algorithm and the <strong>amount of memory</strong> it uses. </li>
<li>When someone says, “<em>This algorithm has worst-case running time of O(n^2) and uses O(n) space,</em>“ they mean <em>“it’s kinda slow but doesn’t need lots of extra memory”</em>.</li>
<li><p>here’s a handy table: </p>
<p>| Big-O        | Name           | Description  |<br>| ————|:————-: | :—————————————-|<br>| O(1)            | constant          |<strong>Best</strong>. The algorithm always takes <strong>the same amount of time</strong>, regardless of how much data there is. Example: <strong>looking up an element of an array by its index</strong>.|<br>| O(log n)     | logarithmic    | <strong>Pretty great</strong>. These kinds of algorithms halve () the amount of data with each iteration. If you have 100 items, it takes about 7 steps to find the answer. With 1,000 items, it takes 10 steps. And 1,000,000 items take 20 steps. <strong>This is super fast even for large amounts of data.</strong> Example: <strong>binary search</strong>.|<br>| O(n)              | linear         | <strong>Good performance</strong>. If you have 100 items, this does 100 units of work. Doubling the number of items makes the algorithm take exactly twice as long (200 units of work). Example: <strong>sequential search</strong>. |<br>| O(n log n)     | “linearithmic” |<strong>OK performance</strong>. This is <strong>slightly worse than linear</strong> but not too bad. Example: the <strong>fastest general-purpose sorting algorithms</strong>.|<br>| O(n^2)         | quadratic      | <strong>Kinda slow</strong>. If you have 100 items, this does 100^2 = 10,000 units of work. Doubling the number of items makes it four times slower (because 2 squared equals 4). Example: <strong>algorithms using nested loops</strong>, such as <strong>insertion sort</strong>.|<br>| O(n^3)         | cubic           | <strong>Poor performance</strong>. If you have 100 items, this does 100^3 = 1,000,000 units of work. Doubling the input size makes it eight times slower. Example: <strong>matrix multiplication</strong>.|<br>| O(2^n)         | exponential    | <strong>Very poor performance</strong>. You want to <strong>avoid</strong> these kinds of algorithms, <strong>but sometimes you have no choice</strong>. Adding just one bit to the input doubles the running time. Example: <strong>traveling salesperson problem</strong>.|<br>| O(n!)         | factorial      | <strong>Intolerably slow</strong>. It literally takes a million years to do anything.|</p>
<p>(n refers to the number of data items that you’re processing)</p>
</li>
</ul>
<h3 id="Below-are-some-examples-for-each-category-of-performance"><a href="#Below-are-some-examples-for-each-category-of-performance" class="headerlink" title="Below are some examples for each category of performance:"></a><strong>Below are some examples for each category of performance:</strong></h3><p><strong>O(1)</strong></p>
<p>The <strong>most common example</strong> with O(1) complexity is <strong>accessing an array index</strong>.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> value = array[<span class="number">5</span>]</span><br></pre></td></tr></table></figure>
<p>Another <strong>example</strong> of O(1) is <strong>pushing and popping from Stack</strong>.</p>
<p><strong>O(log n)</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> j = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> j &lt; n &#123;</span><br><span class="line">  <span class="comment">// do constant time stuff</span></span><br><span class="line">  j *= <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Instead of simply incrementing, ‘j’ is increased by 2 times itself in each run.</p>
<p><strong>Binary Search</strong> is an <strong>example</strong> of O(log n) complexity.</p>
<p><strong>O(n)</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="built_in">print</span>(array[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Array Traversal</strong> and <strong>Linear Search</strong> are examples of O(n) complexity.</p>
<p><strong>O(n log n)</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> j = <span class="number">1</span></span><br><span class="line">  <span class="keyword">while</span> j &lt; n &#123;</span><br><span class="line">    j *= <span class="number">2</span></span><br><span class="line">    <span class="comment">// do constant time stuff</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>OR</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">index</span><span class="params">(after i: Int)</span></span> -&gt; <span class="type">Int</span>? &#123; <span class="comment">// multiplies `i` by 2 until `i` &gt;= `n`</span></span><br><span class="line">    <span class="keyword">return</span> i &lt; n ? i * <span class="number">2</span> : <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> sequence(first: <span class="number">1</span>, next: index(after:)) &#123;</span><br><span class="line">    <span class="comment">// do constant time stuff</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Merge Sort</strong> and <strong>Heap Sort</strong> are examples of O(n log n) complexity.</p>
<p><strong>O(n^2)</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i  <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">1</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// do constant time stuff</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Traversing</strong> a simple 2-D array and <strong>Bubble Sort</strong> are examples of O(n^2) complexity.</p>
<p><strong>O(n^3)</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">1</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">1</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// do constant time stuff</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>O(2^n)</strong></p>
<p>Algorithms with running time O(2^N) are often <strong>recursive(递归) algorithms</strong> that <strong>solve a problem of size N by recursively solving two smaller problems of size N-1</strong>. </p>
<p>The following example prints all the moves necessary to solve the famous “<strong>Towers of Hanoi</strong>“ problem for N disks.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">solveHanoi</span><span class="params">(n: Int, from: String, to: String, spare: String)</span></span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> n &gt;= <span class="number">1</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  <span class="keyword">if</span> n &gt; <span class="number">1</span> &#123;</span><br><span class="line">    solveHanoi(n: n - <span class="number">1</span>, from: from, to: spare, spare: to)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    solveHanoi(n: n - <span class="number">1</span>, from: spare, to: to, spare: from)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>O(n!)</strong></p>
<p>The most trivial/common example of function that takes O(n!) time is:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">nFacFunc</span><span class="params">(n: Int)</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: n, by: <span class="number">1</span>) &#123;</span><br><span class="line">    nFactFunc(n - <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Often you <strong>don’t need math</strong> to figure out what the Big-O is but you can <strong>simply use your intuition</strong>. </p>
<p>If code uses a single loop that looks at all n elements of input, the algorithm is O(n). </p>
<p>If the code has two nested loops, it is O(n^2). Three nested loops gives O(n^3), and so on…</p>
</li>
<li><p>Note that Big-O notation is an estimate and is <strong>only useful for large values of n</strong>. </p>
</li>
<li><p>If you find this confusing, don’t let this Big-O stuff bother you too much. It’s mostly useful when <strong>comparing</strong> two algorithms to figure out which one is better.</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/10/iOS Design Patterns/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/10/iOS Design Patterns/" itemprop="url">iOS Design Patterns</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-10T22:13:00+08:00">
                2018-01-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.raywenderlich.com/46988/ios-design-patterns" title="Permalink to iOS Design Patterns" target="_blank" rel="noopener">Source</a></p>
<h1 id="iOS-Design-Patterns"><a href="#iOS-Design-Patterns" class="headerlink" title="iOS Design Patterns"></a>iOS Design Patterns</h1><p><em>iOS Design Patterns</em> – you’ve probably heard the term, but do you know what it means? While most developers probably agree that design patterns are very important, there aren’t many articles on the subject and we developers sometimes don’t pay too much attention to design patterns while writing code.</p>
<p>Design patterns are reusable solutions to common problems in software design. They’re templates designed to help you write code that’s easy to understand and reuse. They also help you create loosely coupled code so that you can change or replace components in your code without too much of a hassle.</p>
<p>If you’re new to design patterns, then I have good news for you! First, you’re already using tons of iOS design patterns thanks to the way Cocoa is built and the best practices you’re encouraged to use. Second, this tutorial will bring you up to speed on all the major (and not so major) iOS design patterns that are commonly used in Cocoa.</p>
<p>The tutorial is divided into sections, one section per design pattern. In each section, you’ll read an explanation of the following:</p>
<ul>
<li><em>What</em> the design pattern is.</li>
<li><em>Why</em> you should use it.</li>
<li><em>How</em> to use it and, where appropriate, common pitfalls to watch for when using the pattern.</li>
</ul>
<p>In this tutorial, you will create a Music Library app that will display your albums and their relevant information. </p>
<p>In the process of developing this app, you’ll become acquainted with the most common Cocoa design patterns:</p>
<ul>
<li><em>Creational</em>: Singleton and Abstract Factory.</li>
<li><em>Structural</em>: MVC, Decorator, Adapter, Facade and Composite.</li>
<li><em>Behavioral</em>: Observer, Memento, Chain of Responsibility and Command.</li>
</ul>
<p>Don’t be misled into thinking that this is an article about theory; you’ll get to use most of these design patterns in your music app. Your app will look like this by the end of the tutorial:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/07/finalapp-180x320.png" alt="finalapp"></p>
<h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><p>Download the <a href="https://koenig-media.raywenderlich.com/uploads/2013/07/BlueLibrary-Starter.zip" target="_blank" rel="noopener">starter project</a>, extract the contents of the ZIP file, and open <em>BlueLibrary.xcodeproj</em> in Xcode.</p>
<p>There’s not a lot there, just the default <code>ViewController</code> and a simple HTTP Client with empty implementations. </p>
<p><em>Note:</em> Did you know that as soon as you create a new Xcode project your code is already filled with design patterns? MVC, Delegate, Protocol, Singleton – You get them all for free! :]</p>
<p>Before you dive into the first design pattern, you must create two classes to hold and display the album data.</p>
<p>Navigate to <em>“FileNewFile…”</em> (or simply press <em>Command+N</em>). Select <em>iOS &gt; Cocoa Touch</em> and then <em>Objective-C class</em> and click <em>Next</em>. Set the class name to <code>Album</code> and the subclass to <code>NSObject</code>. Click <em>Next</em> and then <em>Create</em>.</p>
<p>Open <em>Album.h</em> and add the following properties and method prototype between <code>@interface</code> and <code>@end</code>:</p>
<pre><code>@property (nonatomic, copy, readonly) NSString *title, *artist, *genre, *coverUrl, *year;

- (id)initWithTitle:(NSString*)title artist:(NSString*)artist coverUrl:(NSString*)coverUrl year:(NSString*)year;
</code></pre><p>Note that all the properties are <em>readonly</em>, since there’s no need to change them after the <code>Album</code> object is created.<br>The method is the object initializer. When you create a new album, you’ll pass in the album name, the artist, the album cover URL, and the year.</p>
<p>Now open <em>Album.m</em> and add the following code between <code>@implementation</code> and <code>@end</code>:</p>
<pre><code>- (id)initWithTitle:(NSString*)title artist:(NSString*)artist coverUrl:(NSString*)coverUrl year:(NSString*)year
{
    self = [super init];
    if (self)
    {
        _title = title;
        _artist = artist;
        _coverUrl = coverUrl;
        _year = year;
        _genre = @&quot;Pop&quot;;
    }
    return self;
}
</code></pre><p>There’s nothing fancy here; just a simple init method to create new <em>Album</em> instances.</p>
<p>Again, navigate to <em>FileNewFile…</em>. Select <em>Cocoa Touch</em> and then <em>Objective-C class</em> and click <em>Next</em>. Set the class name to <em>AlbumView</em>, but this time set the subclass to <em>UIView</em>. Click <em>Next</em> and then <em>Create</em>.</p>
<p><em>Note:</em> If you find keyboard shortcuts easier to use then, <em>Command+N</em> will create a new file, <em>Command+Option+N</em> will create a new group, <em>Command+B</em> will build your project, and <em>Command+R</em> will run it.</p>
<p>Open <em>AlbumView.h</em> and add the following method prototype between <code>@interface</code> and <code>@end</code></p>
<pre><code>- (id)initWithFrame:(CGRect)frame albumCover:(NSString*)albumCover;
</code></pre><p>Now open <em>AlbumView.m</em> and replace all the code after <code>@implementation</code> with the following code:</p>
<pre><code>@implementation AlbumView
{
    UIImageView *coverImage;
    UIActivityIndicatorView *indicator;
}

- (id)initWithFrame:(CGRect)frame albumCover:(NSString*)albumCover
{
    self = [super initWithFrame:frame];
    if (self)
    {

        self.backgroundColor = [UIColor blackColor];
        // the coverImage has a 5 pixels margin from its frame
        coverImage = [[UIImageView alloc] initWithFrame:CGRectMake(5, 5, frame.size.width-10, frame.size.height-10)];
        [self addSubview:coverImage];

        indicator = [[UIActivityIndicatorView alloc] init];
        indicator.center = self.center;
        indicator.activityIndicatorViewStyle = UIActivityIndicatorViewStyleWhiteLarge;
        [indicator startAnimating];
        [self addSubview:indicator];
    }
    return self;
}

@end
</code></pre><p>The first thing you notice here is that there’s an instance variable named <code>coverImage</code>. This variable represents the album cover image. The second variable is an indicator that spins to indicate activity while the cover is being downloaded.</p>
<p>In the implementation of the initializer you set the background to black, create the image view with a small margin of 5 pixels and create and add the activity indicator.</p>
<p><em>Note:</em> Wondering why the private variables were defined in the implementation file and not in the interface file? This is because no class outside the AlbumView class needs to know of the existence of these variables since they are used only in the implementation of the class’s internal functionality. This convention is extremely important if you’re creating a library or framework for other developers to use.</p>
<p>Build your project (<em>Command+B</em>) just to make sure everything is in order. All good? Then get ready for your first design pattern! :]</p>
<h2 id="MVC-–-The-King-of-Design-Patterns"><a href="#MVC-–-The-King-of-Design-Patterns" class="headerlink" title="MVC – The King of Design Patterns"></a>MVC – The King of Design Patterns</h2><p><img src="https://koenig-media.raywenderlich.com/uploads/2013/07/mvcking.png" alt="mvcking"></p>
<p>Model View Controller (MVC) is one of the building blocks of Cocoa and is undoubtedly the most-used design pattern of all. It classifies objects according to their general role in your application and encourages clean separation of code based on role.</p>
<p>The three roles are:</p>
<ul>
<li><em>Model</em>: The object that holds your application data and defines how to manipulate it. For example, in your application the Model is your <code>Album</code> class.</li>
<li><em>View</em>: The objects that are in charge of the visual representation of the Model and the controls the user can interact with; basically, all the <code>UIView</code>s and their subclasses. In your application the View is represented by your <code>AlbumView</code> class.</li>
<li><em>Controller</em>: The controller is the mediator that coordinates all the work. It accesses the data from the model and displays it with the views, listens to events and manipulates the data as necessary. Can you guess which class is your controller? That’s right: <code>ViewController</code>.</li>
</ul>
<p>A good implementation of this design pattern in your application means that each object falls into one of these groups.</p>
<p>The communication between View to Model through Controller can be best described with the following diagram: </p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/07/mvc0.png" alt="mvc0"></p>
<p>The Model notifies the Controller of any data changes, and in turn, the Controller updates the data in the Views. The View can then notify the Controller of actions the user performed and the Controller will either update the Model if necessary or retrieve any requested data.</p>
<p>You might be wondering why you can’t just ditch the Controller, and implement the View and Model in the same class, as that seems a lot easier. </p>
<p>It all comes down to code separation and reusability. Ideally, the View should be completely separated from the Model. If the View doesn’t rely on a specific implementation of the Model, then it can be reused with a different model to present some other data.</p>
<p>For example, if in the future you’d also like to add movies or books to your library, you could still use the same <code>AlbumView</code> to display your movie and book objects. Furthermore, if you want to create a new project that has something to do with albums, you could simply reuse your <code>Album</code> class, because it’s not dependent on any view. That’s the strength of MVC!</p>
<h2 id="How-to-Use-the-MVC-Pattern"><a href="#How-to-Use-the-MVC-Pattern" class="headerlink" title="How to Use the MVC Pattern"></a>How to Use the MVC Pattern</h2><p>First, you need to ensure that each class in your project is either a Controller, a Model or a View; don’t combine the functionality of two roles in one class. You’ve already done a good job so far by creating an <code>Album</code> class and an <code>AlbumView</code> class.</p>
<p>Second, in order to ensure that you conform to this method of work you should create three project groups to hold your code, one for each category.</p>
<p>Navigate to <em>FileNewGroup</em> (or press on <em>Command+Option+N</em>) and name the group <em>Model</em>. Repeat the same process to create <em>View</em> and <em>Controller</em> groups.</p>
<p>Now drag <em>Album.h</em> and <em>Album.m</em> to the Model group. Drag <em>AlbumView.h</em> and <em>AlbumView.m</em> to the View group, and finally drag <em>ViewController.h</em> and <em>ViewController.m</em> to the Controller group.</p>
<p>At this point the project structure should look like this: </p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/07/mvc2-255x320.png" alt="mvc2"></p>
<p>Your project already looks a lot better without all those files floating around. Obviously you can have other groups and classes, but the core of the application is contained in these three categories.</p>
<p>Now that your components are organized, you need to get the album data from somewhere. You’ll create an API class to use throughout your code to manage the data — which presents an opportunity to discuss your next design pattern — the Singleton.</p>
<h2 id="The-Singleton-Pattern"><a href="#The-Singleton-Pattern" class="headerlink" title="The Singleton Pattern"></a>The Singleton Pattern</h2><p>The Singleton design pattern ensures that only one instance exists for a given class and that there’s a global access point to that instance. It usually uses lazy loading to create the single instance when it’s needed the first time.</p>
<p><em>Note:</em> Apple uses this approach a lot. For example: [<code>NSUserDefaults standardUserDefaults]</code>, [<code>UIApplication sharedApplication]</code>, [<code>UIScreen mainScreen]</code>, [<code>NSFileManager defaultManager]</code> all return a Singleton object.</p>
<p>You’re likely wondering why you care if there’s more than one instance of a class floating around. Code and memory is cheap, right?</p>
<p>There are some cases in which it makes sense to have exactly one instance of a class. For example, there’s no need to have multiple <code>Logger</code> instances out there, unless you want to write to several log files at once. Or, take a global configuration handler class: it’s easier to implement a thread-safe access to a single shared resource, such as a configuration file, than to have many class modifying the configuration file possibly at the same time.</p>
<h2 id="How-to-Use-the-Singleton-Pattern"><a href="#How-to-Use-the-Singleton-Pattern" class="headerlink" title="How to Use the Singleton Pattern"></a>How to Use the Singleton Pattern</h2><p>Take a look at the diagram below:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/singleton.png" alt="singleton"></p>
<p>The above image shows a Logger class with a single property (which is the single instance), and two methods: <code>sharedInstance</code> and <code>init</code>.<br>The first time a client sends the <code>sharedInstance</code> message, the property <code>instance</code> isn’t yet initialized, so you create a new instance of the class and return a reference to it. </p>
<p>The next time you call <code>sharedInstance</code>, <code>instance</code> is immediately returned without any initialization. This logic promises that only one instance exists at all times.</p>
<p>You’ll implement this pattern by creating a singleton class to manage all the album data. </p>
<p>You’ll notice there’s a group called <em>API</em> in the project; this is where you’ll put all the classes that will provide services to your app. Inside this group create a new class with the <em>iOSCocoa TouchObjective-C class</em> template. Name the class <em>LibraryAPI</em>, and make it a subclass of <code>NSObject</code>.</p>
<p>Open <em>LibraryAPI.h</em> and replace its contents with the following:</p>
<pre><code>@interface LibraryAPI : NSObject

+ (LibraryAPI*)sharedInstance;

@end
</code></pre><p>Now go to <em>LibraryAPI.m</em> and insert this method right after the <code>@implentation</code> line:</p>
<pre><code>+ (LibraryAPI*)sharedInstance
{
    // 1
    static LibraryAPI *_sharedInstance = nil;

    // 2
    static dispatch_once_t oncePredicate;

    // 3
    dispatch_once(&amp;oncePredicate, ^{
        _sharedInstance = [[LibraryAPI alloc] init];
    });
    return _sharedInstance;
}
</code></pre><p>There’s a lot going on in this short method:</p>
<ol>
<li>Declare a static variable to hold the instance of your class, ensuring it’s available globally inside your class.</li>
<li>Declare the static variable <code>dispatch_once_t</code> which ensures that the initialization code executes only once.</li>
<li>Use Grand Central Dispatch (GCD) to execute a block which initializes an instance of <code>LibraryAPI</code>. This is the essence of the Singleton design pattern: the initializer is never called again once the class has been instantiated.</li>
</ol>
<p>The next time you call <code>sharedInstance</code>, the code inside the <code>dispatch_once</code> block won’t be executed (since it’s already executed once) and you receive a reference to the previously created instance of <code>LibraryAPI</code>.</p>
<p>You now have a Singleton object as the entry point to manage the albums. Take it a step further and create a class to handle the persistence of your library data.</p>
<p>Create a new class with the <em>iOSCocoa TouchObjective-C class</em> template inside the API group. Name the class <code>PersistencyManager</code>, and make it a subclass of <code>NSObject</code>.</p>
<p>Open <em>PersistencyManager.h</em>. Add the following import to the top of the file:</p>
<pre><code>#import &quot;Album.h&quot;
</code></pre><p>Next, add the following code to <em>PersistencyManager.h</em> after the <code>@interface</code> line:</p>
<pre><code>- (NSArray*)getAlbums;
- (void)addAlbum:(Album*)album atIndex:(int)index;
- (void)deleteAlbumAtIndex:(int)index;
</code></pre><p>The above are prototypes for the three methods you need to handle the album data.</p>
<p>Open <em>PersistencyManager.m</em> and add the following code right above the <code>@implementation</code> line:</p>
<pre><code>@interface PersistencyManager () {
    // an array of all albums
    NSMutableArray *albums;
}
</code></pre><p>The above adds a class extension, which is another way to add private methods and variables to a class so that external classes will not know about them. Here, you declare an <code>NSMutableArray</code> to hold the album data. The array’s mutable so that you can easily add and delete albums.</p>
<p>Now add the following code implementation to <em>PersistencyManager.m</em> after the <code>@implementation</code> line:</p>
<pre><code>- (id)init
{
    self = [super init];
    if (self) {
        // a dummy list of albums
        albums = [NSMutableArray arrayWithArray:
                 @[[[Album alloc] initWithTitle:@&quot;Best of Bowie&quot; artist:@&quot;David Bowie&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_david%20bowie_best%20of%20bowie.png&quot; year:@&quot;1992&quot;],
                 [[Album alloc] initWithTitle:@&quot;It&apos;s My Life&quot; artist:@&quot;No Doubt&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_no%20doubt_its%20my%20life%20%20bathwater.png&quot; year:@&quot;2003&quot;],
                 [[Album alloc] initWithTitle:@&quot;Nothing Like The Sun&quot; artist:@&quot;Sting&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_sting_nothing%20like%20the%20sun.png&quot; year:@&quot;1999&quot;],
                 [[Album alloc] initWithTitle:@&quot;Staring at the Sun&quot; artist:@&quot;U2&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_u2_staring%20at%20the%20sun.png&quot; year:@&quot;2000&quot;],
                 [[Album alloc] initWithTitle:@&quot;American Pie&quot; artist:@&quot;Madonna&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_madonna_american%20pie.png&quot; year:@&quot;2000&quot;]]];
    }
    return self;
}
</code></pre><p>In <code>init</code> you populate the array with five sample albums. If the above albums aren’t to your liking, feel free to replace them with the music you enjoy. :]</p>
<p>Now add the following three methods to <em>PersistencyManager.m</em>:</p>
<pre><code>- (NSArray*)getAlbums
{
    return albums;
}

- (void)addAlbum:(Album*)album atIndex:(int)index
{
    if (albums.count &gt;= index)
        [albums insertObject:album atIndex:index];
    else
        [albums addObject:album];
}

- (void)deleteAlbumAtIndex:(int)index
{
    [albums removeObjectAtIndex:index];
}
</code></pre><p>These methods allow you to get, add, and delete albums. </p>
<p>Build your project just to make sure everything still compiles correctly. </p>
<p>At this point, you might wonder where the <code>PersistencyManager</code> class comes in since it’s not a Singleton. The relationship between <code>LibraryAPI</code> and <code>PersistencyManager</code> will be further explored in the next section where you’ll look at the <em>Facade</em> design pattern.</p>
<h2 id="The-Facade-Design-Pattern"><a href="#The-Facade-Design-Pattern" class="headerlink" title="The Facade Design Pattern"></a>The Facade Design Pattern</h2><p><img src="https://koenig-media.raywenderlich.com/uploads/2013/07/facade.jpg" alt="facade"></p>
<p>The Facade design pattern provides a single interface to a complex subsystem. Instead of exposing the user to a set of classes and their APIs, you only expose one simple unified API.</p>
<p>The following image explains this concept:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/07/facade2-480x241.png" alt="facade2"></p>
<p>The user of the API is completely unaware of the complexity that lies beneath. This pattern is ideal when working with a large number of classes, particularly when they are complicated to use or difficult to understand.</p>
<p>The Facade pattern decouples the code that uses the system from the interface and implementation of the classes you’re hiding; it also reduces dependencies of outside code on the inner workings of your subsystem. This is also useful if the classes under the facade are likely to change, as the facade class can retain the same API while things change behind the scenes.<br>For example, if the day comes when you want to replace your backend service, you won’t have to change the code that uses your API as it wont’ change.</p>
<h2 id="How-to-Use-the-Facade-Pattern"><a href="#How-to-Use-the-Facade-Pattern" class="headerlink" title="How to Use the Facade Pattern"></a>How to Use the Facade Pattern</h2><p>Currently you have <code>PersistencyManager</code> to save the album data locally and <code>HTTPClient</code> to handle the remote communication. The other classes in your project should not be aware of this logic. </p>
<p>To implement this pattern, only <code>LibraryAPI</code> should hold instances of <code>PersistencyManager</code> and <code>HTTPClient</code>. Then, <code>LibraryAPI</code> will expose a simple API to access those services. </p>
<p><em>Note:</em> Usually, a singleton exists for the lifetime of the app. You shouldn’t keep too many strong pointers in the singleton to other objects, since they won’t be released until the app is closed.</p>
<p>The design looks like the following:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/design-patterns-facade-uml-480x71.png" alt="design-patterns-facade-uml"></p>
<p>LibraryAPI will be exposed to other code, but will hide the <code>HTTPClient</code> and <code>PersistencyManager</code> complexity from the rest of the app.</p>
<p>Open <em>LibraryAPI.h</em> and add the following import to the top of the file:</p>
<pre><code>#import &quot;Album.h&quot;
</code></pre><p>Next, add the following method definitions to <em>LibraryAPI.h</em>:</p>
<pre><code>- (NSArray*)getAlbums;
- (void)addAlbum:(Album*)album atIndex:(int)index;
- (void)deleteAlbumAtIndex:(int)index;
</code></pre><p>For now, these are the methods you’ll expose to the other classes. </p>
<p>Go to <em>LibraryAPI.m</em> and add the following two imports:</p>
<pre><code>#import &quot;PersistencyManager.h&quot;
#import &quot;HTTPClient.h&quot;
</code></pre><p>This will be the only place where you import these classes. Remember: your API will be the only access point to your “complex” system. </p>
<p>Now, add some private variables via a class extension (above the <code>@implementation</code> line):</p>
<pre><code>@interface LibraryAPI () {
    PersistencyManager *persistencyManager;
    HTTPClient *httpClient;
    BOOL isOnline;
}

@end
</code></pre><p><code>isOnline</code> determines if the server should be updated with any changes made to the albums list, such as added or deleted albums.</p>
<p>You now need to initialize these variables via <code>init</code>. Add the following code to <em>LibraryAPI.m</em>:</p>
<pre><code>- (id)init
{
    self = [super init];
    if (self) {
        persistencyManager = [[PersistencyManager alloc] init];
        httpClient = [[HTTPClient alloc] init];
        isOnline = NO;
    }
    return self;
}
</code></pre><p>The HTTP client doesn’t actually work with a real server and is only here to demonstrate the usage of the facade pattern, so <code>isOnline</code> will always be <code>NO</code>.</p>
<p>Next, add the following three methods to <em>LibraryAPI.m</em>:</p>
<pre><code>- (NSArray*)getAlbums
{
    return [persistencyManager getAlbums];
}

- (void)addAlbum:(Album*)album atIndex:(int)index
{
    [persistencyManager addAlbum:album atIndex:index];
    if (isOnline)
    {
        [httpClient postRequest:@&quot;/api/addAlbum&quot; body:[album description]];
    }
}

- (void)deleteAlbumAtIndex:(int)index
{
    [persistencyManager deleteAlbumAtIndex:index];
    if (isOnline)
    {
        [httpClient postRequest:@&quot;/api/deleteAlbum&quot; body:[@(index) description]];
    }
}
</code></pre><p>Take a look at <code>addAlbum:atIndex:</code>. The class first updates the data locally, and then if there’s an internet connection, it updates the remote server. This is the real strength of the Facade; when some class outside of your system adds a new album, it doesn’t know — and doesn’t need to know — of the complexity that lies underneath.</p>
<p><em>Note:</em> When designing a Facade for classes in your subsystem, remember that nothing prevents the client from accessing these “hidden” classes directly. Don’t be stingy with defensive code and don’t assume that all the clients will necessarily use your classes the same way the Facade uses them.</p>
<p>Build and run your app. You’ll see an incredibly exciting empty black screen like this:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/09/2013-09-01_12-08-44-211x320.png" alt="Blank screen"></p>
<p>You’ll need something to display the album data on screen — which is a perfect use for your next design pattern: the <em>Decorator</em>.</p>
<h2 id="The-Decorator-Design-Pattern"><a href="#The-Decorator-Design-Pattern" class="headerlink" title="The Decorator Design Pattern"></a>The Decorator Design Pattern</h2><p>The Decorator pattern dynamically adds behaviors and responsibilities to an object without modifying its code. It’s an alternative to subclassing where you modify a class’ behavior by wrapping it with another object.</p>
<p>In Objective-C there are two <em>very</em> common implementations of this pattern: <em>Category</em> and <em>Delegation</em>.</p>
<h3 id="Category"><a href="#Category" class="headerlink" title="Category"></a>Category</h3><p>Category is an extremely powerful mechanism that allows you to add methods to existing classes without subclassing. The new methods are added at compile time and can be executed like normal methods of the extended class. It’s slightly different from the classic definition of a decorator, because a Category doesn’t hold an instance of the class it extends.</p>
<p><em>Note:</em> Besides extending your own classes, you can also add methods to any of Cocoa’s own classes!</p>
<h3 id="How-to-Use-Categories"><a href="#How-to-Use-Categories" class="headerlink" title="How to Use Categories"></a>How to Use Categories</h3><p>Imagine a situation in which you have an <code>Album</code> object that you want to present inside a table view:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/design-patterns-category1.png" alt="design-patterns-category1"></p>
<p>Where will the album titles come from? <code>Album</code> is a Model object, so it doesn’t care how you present the data. You’ll need some external code to add this functionality to the <code>Album</code> class, but without modifying the class directly.</p>
<p>You’ll create a category that is an extension of <code>Album</code>; it will define a new method that returns a data structure which can be used easily with <code>UITableView</code>s. </p>
<p>The data structure will look like the following:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/delegate2-480x67.png" alt="delegate2"></p>
<p>To add a Category to <code>Album</code>, navigate to <em>FileNewFile…</em> and select the <em>Objective-C category</em> template — don’t select the <em>Objective-C class</em> out of habit! Enter <code>TableRepresentation</code> in the <em>Category</em> field and <code>Album</code> in the <em>Category on</em> field.</p>
<p><em>Note:</em> Did you notice the name of the new file? <code>Album+TableRepresentation</code> means you’re extending the <code>Album</code> class. This convention is important, because it’s easier to read and it prevents a collision with other categories you or someone else might create.</p>
<p>Go to <em>Album+TableRepresentation.h</em> and add the following method prototype:</p>
<pre><code>- (NSDictionary*)tr_tableRepresentation;
</code></pre><p>Notice there’s a <code>tr_</code> at the beginning of the method name, as an abbreviation of the name of the category: TableRepresentation. Again, conventions like this will help prevent collisions with other methods!</p>
<p><em>Note:</em> If the name of a method declared in a category is the same as a method in the original class, or the same as a method in another category on the same class (or even a superclass), the behavior is <em>undefined</em> as to which method implementation is used at runtime. This is less likely to be an issue if you’re using categories with your own classes, but can cause serious problems when using categories to add methods to standard Cocoa or Cocoa Touch classes.</p>
<p>Go to <em>Album+TableRepresentation.m</em> and add the following method:</p>
<pre><code>- (NSDictionary*)tr_tableRepresentation
{
    return @{@&quot;titles&quot;:@[@&quot;Artist&quot;, @&quot;Album&quot;, @&quot;Genre&quot;, @&quot;Year&quot;],
             @&quot;values&quot;:@[self.artist, self.title, self.genre, self.year]};
}
</code></pre><p>Consider for a moment how powerful this pattern can be:</p>
<ul>
<li>You’re using properties directly from <code>Album</code>.</li>
<li>You have added to the <code>Album</code> class but you haven’t subclassed it. If you need to sub-class <code>Album</code>, you can still do that too.</li>
<li>This simple addition lets you return a <code>UITableView</code>–<em>ish</em> representation of an <code>Album</code>, without modifying <code>Album</code>‘s code.</li>
</ul>
<p>Apple uses Categories a lot in the Foundation classes. To see how they do this, open <em>NSString.h</em>. Find <code>@interface NSString</code>, and you’ll see the definition of the class together with three categories: <code>NSStringExtensionMethods</code>, <code>NSExtendedStringPropertyListParsing</code> and <code>NSStringDeprecated</code>. Categories help keep the methods organized and separated into sections.</p>
<h3 id="Delegation"><a href="#Delegation" class="headerlink" title="Delegation"></a>Delegation</h3><p>The other Decorator design pattern, Delegation, is a mechanism in which one object acts on behalf of, or in coordination with, another object. For example, when you use a <code>UITableView</code>, one of the methods you must implement is <code>tableView:numberOfRowsInSection:</code>. </p>
<p>You can’t expect the <code>UITableView</code> to know how many rows you want to have in each section, as this is application-specific. Therefore, the task of calculating the amount of rows in each section is passed on to the <code>UITableView</code> delegate. This allows the <code>UITableView</code> class to be independent of the data it displays.</p>
<p>Here’s a pseudo-explanation of what’s going on when you create a new <code>UITableView</code>:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/delegate-480x252.png" alt="delegate"></p>
<p>The <code>UITableView</code> object does its job of displaying a table view. However, eventually it will need some information that it doesn’t have. Then, it turns to its delegates and sends a message asking for additional information. In Objective-C’s implementation of the delegate pattern, a class can declare optional and required methods through a protocol. You’ll cover protocols a bit later in this tutorial.</p>
<p>It might seem easier to just subclass an object and override the necessary methods, but consider that you can only subclass based on a single class. If you want an object to be the delegate of two or more other objects, you won’t be able to achieve this by subclassing.</p>
<p><em>Note:</em> This is an important pattern. Apple uses this approach in most of the UIKit classes: <code>UITableView</code>, <code>UITextView</code>, <code>UITextField</code>, <code>UIWebView</code>, <code>UIAlert</code>, <code>UIActionSheet</code>, <code>UICollectionView</code>, <code>UIPickerView</code>, <code>UIGestureRecognizer</code>, <code>UIScrollView</code>. The list goes on and on.</p>
<h3 id="How-to-Use-the-Delegate-Pattern"><a href="#How-to-Use-the-Delegate-Pattern" class="headerlink" title="How to Use the Delegate Pattern"></a>How to Use the Delegate Pattern</h3><p>Go to <em>ViewController.m</em> and add the following imports to the top of the file:</p>
<pre><code>#import &quot;LibraryAPI.h&quot;
#import &quot;Album+TableRepresentation.h&quot;
</code></pre><p>Now, add these private variables to the class extension so that the class extension looks like this:</p>
<pre><code>@interface ViewController () {
    UITableView *dataTable;
    NSArray *allAlbums;
    NSDictionary *currentAlbumData;
    int currentAlbumIndex;
}

@end
</code></pre><p>Then, replace the <code>@interface</code> line in the class extension with this one:</p>
<pre><code>@interface ViewController ()  {
</code></pre><p>This is how you make your delegate conform to a protocol — think of it as a promise made by the delegate to fulfil the method’s contract. Here, you indicate that <code>ViewController</code> will conform to the <code>UITableViewDataSource</code> and <code>UITableViewDelegate</code> protocols. This way <code>UITableView</code> can be absolutely certain that the required methods are implemented by its delegate.</p>
<p>Next, replace <code>viewDidLoad:</code> with this code:</p>
<pre><code>- (void)viewDidLoad
{
    [super viewDidLoad];
    // 1
    self.view.backgroundColor = [UIColor colorWithRed:0.76f green:0.81f blue:0.87f alpha:1];
    currentAlbumIndex = 0;

    //2
    allAlbums = [[LibraryAPI sharedInstance] getAlbums];

    // 3
    // the uitableview that presents the album data
    dataTable = [[UITableView alloc] initWithFrame:CGRectMake(0, 120, self.view.frame.size.width, self.view.frame.size.height-120) style:UITableViewStyleGrouped];
    dataTable.delegate = self;
    dataTable.dataSource = self;
    dataTable.backgroundView = nil;
    [self.view addSubview:dataTable];
}
</code></pre><p>Here’s a breakdown of the above code:</p>
<ol>
<li>Change the background color to a nice navy blue color.</li>
<li>Get a list of all the albums via the API. You don’t use <code>PersistencyManager</code> directly!</li>
<li>This is where you create the <code>UITableView</code>. You declare that the view controller is the <code>UITableView</code> delegate/data source; therefore, all the information required by <code>UITableView</code> will be provided by the view controller.</li>
</ol>
<p>Now, add the following method to <em>ViewController.m</em>:</p>
<pre><code>- (void)showDataForAlbumAtIndex:(int)albumIndex
{
    // defensive code: make sure the requested index is lower than the amount of albums
    if (albumIndex &lt; allAlbums.count)
    {
        // fetch the album
        Album *album = allAlbums[albumIndex];
        // save the albums data to present it later in the tableview
        currentAlbumData = [album tr_tableRepresentation];
    }
    else
    {
        currentAlbumData = nil;
    }

    // we have the data we need, let&apos;s refresh our tableview    
    [dataTable reloadData];
}
</code></pre><p><code>showDataForAlbumAtIndex:</code> fetches the required album data from the array of albums. When you want to present the new data, you just need to call <code>reloadData</code>. This causes <code>UITableView</code> to ask its delegate such things as how many sections should appear in the table view, how many rows in each section, and how each cell should look.</p>
<p>Add the following line to the end of <code>viewDidLoad</code></p>
<pre><code>[self showDataForAlbumAtIndex:currentAlbumIndex];
</code></pre><p>This loads the current album at app launch. And since <code>currentAlbumIndex</code> was previously set to 0, this shows the first album in the collection.</p>
<p>Build and run your project; you’ll experience a crash with the following exception displayed in the debug console:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/09/2013-09-01_15-57-32-700x112.png" alt="UITableView Crash"></p>
<p>What’s going on here? You declared that <code>ViewController</code> as the <code>UITableView</code>‘s delegate and data source. But in doing so, you <em>must</em> conform to all the required methods — including <code>tableView:numberOfRowsInSection:</code> — which you haven’t done yet.</p>
<p>Add the following code to <em>ViewController.m</em> anywhere between the <code>@implementation</code> and <code>@end</code> lines:</p>
<pre><code>- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [currentAlbumData[@&quot;titles&quot;] count];
}

- (UITableViewCell*)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@&quot;cell&quot;];
    if (!cell)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:@&quot;cell&quot;];
    }

    cell.textLabel.text = currentAlbumData[@&quot;titles&quot;][indexPath.row];
    cell.detailTextLabel.text = currentAlbumData[@&quot;values&quot;][indexPath.row];

    return cell;
}
</code></pre><p><code>tableView:numberOfRowsInSection:</code> returns the number of rows to display in the table view, which matches the number of titles in the data structure. </p>
<p><code>tableView:cellForRowAtIndexPath:</code> creates and returns a cell with the title and its value.</p>
<p>Build and run your project. Your app should start and present you with the following screen:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/design-pattern-stage1.png" alt="design pattern - stage1"></p>
<p>Things are looking pretty good so far. But if you recall the first image showing the finished app, there was a horizontal scroller at the top of the screen to switch between albums. Instead of coding a single-purpose horizontal scroller, why not make it reusable for any view?</p>
<p>To make this view reusable, all decisions about its content should be left to another object: a delegate. The horizontal scroller should declare methods that its delegate implements in order to work with the scroller, similar to how the <code>UITableView</code> delegate methods work. We’ll implement this when we discuss the next design pattern.</p>
<h2 id="The-Adapter-Pattern"><a href="#The-Adapter-Pattern" class="headerlink" title="The Adapter Pattern"></a>The Adapter Pattern</h2><p>An Adapter allows classes with incompatible interfaces to work together. It wraps itself around an object and exposes a standard interface to interact with that object.</p>
<p>If you’re familiar with the Adapter pattern then you’ll notice that Apple implements it in a slightly different manner - Apple uses protocols to do the job. You may be familiar with protocols like <code>UITableViewDelegate</code>, <code>UIScrollViewDelegate</code>, <code>NSCoding</code> and <code>NSCopying</code>. As an example, with the <code>NSCopying</code> protocol, any class can provide a standard <code>copy</code> method.</p>
<h2 id="How-to-Use-the-Adapter-Pattern"><a href="#How-to-Use-the-Adapter-Pattern" class="headerlink" title="How to Use the Adapter Pattern"></a>How to Use the Adapter Pattern</h2><p>The horizontal scroller mentioned before will look like this:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/protocol1.png" alt="protocol1"></p>
<p>To begin implementing it, right click on the View group in the Project Navigator, select <em>New File…</em> and create a class with the <em>iOSCocoa TouchObjective-C class</em> template. Name the new class <em>HorizontalScroller</em> and make it subclass from <code>UIView</code>.</p>
<p>Open <em>HorizontalScroller.h</em> and insert the following code <em>after</em> the <code>@end</code> line:</p>
<pre><code>@protocol HorizontalScrollerDelegate 
// methods declaration goes in here
@end
</code></pre><p>This defines a protocol named <code>HorizontalScrollerDelegate</code> that inherits from the <code>NSObject</code> protocol in the same way that an Objective-C class inherits from its parent. It’s good practice to conform to the <code>NSObject</code> protocol — or to conform to a protocol that itself conforms to the <code>NSObject</code> protocol. This lets you send messages defined by <code>NSObject</code> to the delegate of <code>HorizontalScroller</code>. You’ll soon see why this is important.</p>
<p>You define the required and optional methods that the delegate will implement between the <code>@protocol</code> and <code>@end</code> lines. So add the following protocol methods:</p>
<pre><code>@required
// ask the delegate how many views he wants to present inside the horizontal scroller
- (NSInteger)numberOfViewsForHorizontalScroller:(HorizontalScroller*)scroller;

// ask the delegate to return the view that should appear at 
- (UIView*)horizontalScroller:(HorizontalScroller*)scroller viewAtIndex:(int)index;

// inform the delegate what the view at  has been clicked
- (void)horizontalScroller:(HorizontalScroller*)scroller clickedViewAtIndex:(int)index;

@optional
// ask the delegate for the index of the initial view to display. this method is optional
// and defaults to 0 if it&apos;s not implemented by the delegate
- (NSInteger)initialViewIndexForHorizontalScroller:(HorizontalScroller*)scroller;
</code></pre><p>Here you have both required and optional methods. Required methods must be implemented by the delegate and usually contain some data that is absolutely required by the class. In this case, the required details are the number of views, the view at a specific index, and the behaviour when the view is tapped. The optional method here is the initial view; if it’s not implemented then the <code>HorizontalScroller</code> will default to the first index.</p>
<p>Next, you’ll need to refer to your new delegate from within the <code>HorizontalScroller</code> class definition. But the protocol definition is below the class definition and so is not <em>visible</em> at this point. What can you do?</p>
<p>The solution is to forward declare the protocol so that the compiler (and Xcode) knows that such a protocol will be available. To do this, add the following code <em>above</em> the @interface line:</p>
<pre><code>@protocol HorizontalScrollerDelegate;
</code></pre><p>Still in <em>HorizontalScroller.h</em>, add the following code between the <code>@interface</code> and <code>@end</code> statements:</p>
<pre><code>@property (weak) id delegate;

- (void)reload;
</code></pre><p>The attribute of the property you created above is defined as <code>weak</code>. This is necessary in order to prevent a retain cycle. If a class keeps a <code>strong</code> pointer to its delegate and the delegate keeps a strong pointer back to the conforming class, your app will leak memory since neither class will release the memory allocated to the other.</p>
<p>The <code>id</code> means that the delegate can only be assigned classes that conform to <code>HorizontalScrollerDelegate</code>, giving you some type safety.</p>
<p>The <code>reload</code> method is modelled after <code>reloadData</code> in <code>UITableView</code>; it reloads all the data used to construct the horizontal scroller.</p>
<p>Replace the contents of <em>HorizontalScroller.m</em> with the following code:</p>
<pre><code>#import &quot;HorizontalScroller.h&quot;

// 1
#define VIEW_PADDING 10
#define VIEW_DIMENSIONS 100
#define VIEWS_OFFSET 100

// 2
@interface HorizontalScroller () 
@end

// 3
@implementation HorizontalScroller
{
    UIScrollView *scroller;
}

@end
</code></pre><p>Taking each comment block in turn:</p>
<ol>
<li>Define constants to make it easy to modify the layout at design time. The view’s dimensions inside the scroller will be 100 x 100 with a 10 point margin from its enclosing rectangle.</li>
<li><code>HorizontalScroller</code> conforms to the <code>UIScrollViewDelegate</code> protocol. Since <code>HorizontalScroller</code> uses a <code>UIScrollView</code> to scroll the album covers, it needs to know of user events such as when a user stops scrolling.</li>
<li>Create the scroll view containing the views.</li>
</ol>
<p>Next you need to implement the initializer. Add the following method:</p>
<pre><code>- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self)
    {
        scroller = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)];
        scroller.delegate = self;
        [self addSubview:scroller];
        UITapGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(scrollerTapped:)];
        [scroller addGestureRecognizer:tapRecognizer];
    }
    return self;
}
</code></pre><p>The scroll view completely fills the <code>HorizontalScroller</code>. A <code>UITapGestureRecognizer</code> detects touches on the scroll view and checks if an album cover has been tapped. If so, it notifies the <code>HorizontalScroller</code> delegate.</p>
<p>Now add this mehtod:</p>
<pre><code>- (void)scrollerTapped:(UITapGestureRecognizer*)gesture
{
    CGPoint location = [gesture locationInView:gesture.view];
    // we can&apos;t use an enumerator here, because we don&apos;t want to enumerate over ALL of the UIScrollView subviews.
    // we want to enumerate only the subviews that we added
    for (int index=0; index&lt;[self.delegate numberOfViewsForHorizontalScroller:self]; index++)
    {
        UIView *view = scroller.subviews[index];
        if (CGRectContainsPoint(view.frame, location))
        {
            [self.delegate horizontalScroller:self clickedViewAtIndex:index];
            [scroller setContentOffset:CGPointMake(view.frame.origin.x - self.frame.size.width/2 + view.frame.size.width/2, 0) animated:YES];
            break;
        }
    }
}
</code></pre><p>The gesture passed in as a parameter lets you extract the location via <code>locationInView:</code>.</p>
<p>Next, you invoke <code>numberOfViewsForHorizontalScroller:</code> on the delegate. The <code>HorizontalScroller</code> instance has no information about the delegate other than knowing it can safely send this message since the delegate must conform to the <code>HorizontalScrollerDelegate</code> protocol.</p>
<p>For each view in the scroll view, perform a hit test using <code>CGRectContainsPoint</code> to find the view that was tapped. When the view is found, send the delegate the <code>horizontalScroller:clickedViewAtIndex:</code> message. Before you break out of the for loop, center the tapped view in the scroll view.</p>
<p>Now add the following code to reload the scroller:</p>
<pre><code>- (void)reload
{
    // 1 - nothing to load if there&apos;s no delegate
    if (self.delegate == nil) return;

    // 2 - remove all subviews
    [scroller.subviews enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        [obj removeFromSuperview];
    }];

    // 3 - xValue is the starting point of the views inside the scroller
    CGFloat xValue = VIEWS_OFFSET;
    for (int i=0; i&lt;[self.delegate numberOfViewsForHorizontalScroller:self]; i++)
    {
        // 4 - add a view at the right position
        xValue += VIEW_PADDING;
        UIView *view = [self.delegate horizontalScroller:self viewAtIndex:i];
        view.frame = CGRectMake(xValue, VIEW_PADDING, VIEW_DIMENSIONS, VIEW_DIMENSIONS);
        [scroller addSubview:view];
        xValue += VIEW_DIMENSIONS+VIEW_PADDING;
    }

    // 5
    [scroller setContentSize:CGSizeMake(xValue+VIEWS_OFFSET, self.frame.size.height)];

    // 6 - if an initial view is defined, center the scroller on it
    if ([self.delegate respondsToSelector:@selector(initialViewIndexForHorizontalScroller:)])
    {
        int initialView = [self.delegate initialViewIndexForHorizontalScroller:self];
        [scroller setContentOffset:CGPointMake(initialView*(VIEW_DIMENSIONS+(2*VIEW_PADDING)), 0) animated:YES];
    }
}
</code></pre><p>Stepping through the code comment-by-comment:</p>
<ol>
<li>If there’s no delegate, then there’s nothing to be done and you can return.</li>
<li>Remove all the subviews previously added to the scroll view.</li>
<li>All the views are positioned starting from the given offset. Currently it’s 100, but it can be easily tweaked by changing the <code>#DEFINE</code> at the top of the file.</li>
<li>The <code>HorizontalScroller</code> asks its delegate for the views one at a time and it lays them next to each another horizontally with the previously defined padding.</li>
<li>Once all the views are in place, set the content offset for the scroll view to allow the user to scroll through all the albums covers.</li>
<li>The <code>HorizontalScroller</code> checks if its delegate responds to the <code>initialViewIndexForHorizontalScroller:</code> selector. This check is necessary because that particular protocol method is optional. If the delegate doesn’t implement this method, 0 is used as the default value. Finally, this piece of code sets the scroll view to center the initial view defined by the delegate.</li>
</ol>
<p>You execute <code>reload</code> when your data has changed. You also need to call this method when you add <code>HorizontalScroller</code> to another view. Add the following code to <em>HorizontalScroller.m</em> to cover the latter scenario:</p>
<pre><code>- (void)didMoveToSuperview
{
    [self reload];
}
</code></pre><p>The <code>didMoveToSuperview</code> message is sent to a view when it’s added to another view as a subview. This is the right time to reload the contents of the scroller.</p>
<p>The last piece of the <code>HorizontalScroller</code> puzzle is to make sure the album you’re viewing is always centered inside the scroll view. To do this, you’ll need to perform some calculations when the user drags the scroll view with their finger. </p>
<p>Add the following method (again to <em>HorizontalScroller.m</em>):</p>
<pre><code>- (void)centerCurrentView
{
    int xFinal = scroller.contentOffset.x + (VIEWS_OFFSET/2) + VIEW_PADDING;
    int viewIndex = xFinal / (VIEW_DIMENSIONS+(2*VIEW_PADDING));
    xFinal = viewIndex * (VIEW_DIMENSIONS+(2*VIEW_PADDING));
    [scroller setContentOffset:CGPointMake(xFinal,0) animated:YES];
    [self.delegate horizontalScroller:self clickedViewAtIndex:viewIndex];
}
</code></pre><p>The above code takes into account the current offset of the scroll view and the dimensions and the padding of the views in order to calculate the distance of the current view from the center. The last line is important: once the view is centered, you then inform the delegate that the selected view has changed.</p>
<p>To detect that the user finished dragging inside the scroll view, you must add the following <code>UIScrollViewDelegate</code> methods:</p>
<pre><code>- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
    if (!decelerate)
    {
        [self centerCurrentView];
    }
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{
    [self centerCurrentView];
}
</code></pre><p><code>scrollViewDidEndDragging:willDecelerate:</code> informs the delegate when the user finishes dragging. The <code>decelerate</code> parameter is true if the scroll view hasn’t come to a complete stop yet. When the scroll action ends, the the system calls <code>scrollViewDidEndDecelerating</code>. In both cases we should call the new method to center the current view since the current view probably has changed after the user dragged the scroll view.</p>
<p>Your <code>HorizontalScroller</code> is ready for use! Browse through the code you’ve just written; you’ll see there’s not one single mention of the <code>Album</code> or <code>AlbumView</code> classes. That’s excellent, because this means that the new scroller is truly independent and reusable.</p>
<p>Build your project to make sure everything compiles properly.</p>
<p>Now that <code>HorizontalScroller</code> is complete, it’s time to use it in your app. Open <em>ViewController.m</em> and add the following imports:</p>
<pre><code>#import &quot;HorizontalScroller.h&quot;
#import &quot;AlbumView.h&quot;
</code></pre><p>Add <code>HorizontalScrollerDelegate</code> to the protocols that <code>ViewController</code> conforms to:</p>
<pre><code>@interface ViewController ()
</code></pre><p>Add the following instance variable for the Horizontal Scroller to the class extension:</p>
<pre><code>HorizontalScroller *scroller;
</code></pre><p>Now you can implement the delegate methods; you’ll be amazed at how just a few lines of code can implement a lot of functionality.</p>
<p>Add the following code to <em>ViewController.m</em>:</p>
<pre><code>#pragma mark - HorizontalScrollerDelegate methods
- (void)horizontalScroller:(HorizontalScroller *)scroller clickedViewAtIndex:(int)index
{
    currentAlbumIndex = index;
    [self showDataForAlbumAtIndex:index];
}
</code></pre><p>This sets the variable that stores the current album and then calls <code>showDataForAlbumAtIndex:</code> to display the data for the new album.</p>
<p><em>Note:</em> It’s common practice to place methods that fit together after a <code>#pragma mark</code> directive. The compiler will ignore this line but if you drop down the list of methods in your current file via Xcode’s jump bar, you’ll see a separator and a bold title for the directive. This helps you organize your code for easy navigation in Xcode.</p>
<p>Next, add the following code:</p>
<pre><code>- (NSInteger)numberOfViewsForHorizontalScroller:(HorizontalScroller*)scroller
{
    return allAlbums.count;
}
</code></pre><p>This, as you’ll recognize, is the protocol method returning the number of views for the scroll view. Since the scroll view will display covers for all the album data, the count is the number of album records.</p>
<p>Now, add this code:</p>
<pre><code>- (UIView*)horizontalScroller:(HorizontalScroller*)scroller viewAtIndex:(int)index
{
    Album *album = allAlbums[index];
    return [[AlbumView alloc] initWithFrame:CGRectMake(0, 0, 100, 100) albumCover:album.coverUrl];
}
</code></pre><p>Here you create a new <code>AlbumView</code> and pass it to the <code>HorizontalScroller</code>.</p>
<p>That’s it! Only three short methods to display a nice looking horizontal scroller.</p>
<p>Yes, you still need to actually create the scroller and add it to your main view but before doing that, add the following method:</p>
<pre><code>- (void)reloadScroller
{
    allAlbums = [[LibraryAPI sharedInstance] getAlbums];
    if (currentAlbumIndex &lt; 0) currentAlbumIndex = 0;
    else if (currentAlbumIndex &gt;= allAlbums.count) currentAlbumIndex = allAlbums.count-1;
    [scroller reload];

    [self showDataForAlbumAtIndex:currentAlbumIndex];
}
</code></pre><p>This method loads album data via <code>LibraryAPI</code> and then sets the currently displayed view based on the current value of the current view index. If the current view index is less than 0, meaning that no view was currently selected, then the first album in the list is displayed. Otherwise, the last album is displayed.</p>
<p>Now, initialize the scroller by adding the following code to <code>viewDidLoad</code> before[<code>self showDataForAlbumAtIndex:0];</code>:</p>
<pre><code>scroller = [[HorizontalScroller alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, 120)];
scroller.backgroundColor = [UIColor colorWithRed:0.24f green:0.35f blue:0.49f alpha:1];
scroller.delegate = self;
[self.view addSubview:scroller];

[self reloadScroller];
</code></pre><p>The above simply creates a new instance of <code>HorizontalScroller</code>, sets its background color and delegate, adds the scroller to the main view, and then loads the subviews for the scroller to display album data.</p>
<p><em>Note:</em> If a protocol becomes too big and is packed with a lot of methods, you should consider breaking it into several smaller protocols. <code>UITableViewDelegate</code> and <code>UITableViewDataSource</code> are a good example, since they are both protocols of <code>UITableView</code>. Try to design your protocols so that each one handles one specific area of functionality.</p>
<p>Build and run your project and take a look at your awesome new horizontal scroller:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/design-patterns-3-298x320.png" alt="design-patterns-3"></p>
<p>Uh, wait. The horizontal scroller is in place, but where are the covers? </p>
<p>Ah, that’s right — you didn’t implement the code to download the covers yet. To do that, you’ll need to add a way to download images. Since all your access to services goes through <code>LibraryAPI</code>, that’s where this new method would have to go. However, there are a few things to consider first:</p>
<ol>
<li><code>AlbumView</code> shouldn’t work directly with <code>LibraryAPI</code>. You don’t want to mix view logic with communication logic.</li>
<li>For the same reason, <code>LibraryAPI</code> shouldn’t know about <code>AlbumView</code>.</li>
<li><code>LibraryAPI</code> needs to inform <code>AlbumView</code> once the covers are downloaded since the <code>AlbumView</code> has to display the covers.</li>
</ol>
<p>Sounds like a conundrum? Don’t despair, you’ll learn how to do this using the <em>Observer</em> pattern :]</p>
<h2 id="The-Observer-Pattern"><a href="#The-Observer-Pattern" class="headerlink" title="The Observer Pattern"></a>The Observer Pattern</h2><p>In the Observer pattern, one object notifies other objects of any state changes. The objects involved don’t need to know about one another - thus encouraging a decoupled design. This pattern’s most often used to notify interested objects when a property has changed.</p>
<p>The usual implementation requires that an observer registers interest in the state of another object. When the state changes, all the observing objects are notified of the change. Apple’s Push Notification service is a global example of this.</p>
<p>If you want to stick to the MVC concept (hint: you do), you need to allow Model objects to communicate with View objects, but without direct references between them. And that’s where the Observer pattern comes in.</p>
<p>Cocoa implements the observer pattern in two familiar ways: <em>Notifications</em> and <em>Key-Value Observing (KVO)</em>.</p>
<h3 id="Notifications"><a href="#Notifications" class="headerlink" title="Notifications"></a>Notifications</h3><p>Not be be confused with Push or Local notifications, Notifications are based on a subscribe-and-publish model that allows an object (the publisher) to send messages to other objects (subscribers/listeners). The publisher never needs to know anything about the subscribers.<br>Notifications are heavily used by Apple. For example, when the keyboard is shown/hidden the system sends a <code>UIKeyboardWillShowNotification</code>/<code>UIKeyboardWillHideNotification</code>, respectively. When your app goes to the background, the system sends a <code>UIApplicationDidEnterBackgroundNotification</code> notification.</p>
<p><em>Note:</em> Open up <em>UIApplication.h</em>, at the end of the file you’ll see a list of over 20 notifications sent by the system.</p>
<h3 id="How-to-Use-Notifications"><a href="#How-to-Use-Notifications" class="headerlink" title="How to Use Notifications"></a>How to Use Notifications</h3><p>Go to <em>AlbumView.m</em> and insert the following code after [<code>self addSubview:indicator];</code> in <code>initWithFrame:albumCover:</code>:</p>
<pre><code>[[NSNotificationCenter defaultCenter] postNotificationName:@&quot;BLDownloadImageNotification&quot;
                                                    object:self
                                                  userInfo:@{@&quot;imageView&quot;:coverImage, @&quot;coverUrl&quot;:albumCover}];
</code></pre><p>This line sends a notification through the <code>NSNotificationCenter</code> singleton. The notification info contains the <code>UIImageView</code> to populate and the URL of the cover image to be downloaded. That’s all the information you need to perform the cover download task.</p>
<p>Add the following line to <code>init</code> in <em>LibraryAPI.m</em>, directly after <code>isOnline = NO</code>:</p>
<pre><code>[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(downloadImage:) name:@&quot;BLDownloadImageNotification&quot; object:nil];
</code></pre><p>This is the other side of the equation: the observer. Every time an <code>AlbumView</code> class posts a <code>BLDownloadImageNotification</code> notification, since <code>LibraryAPI</code> has registered as an observer for the same notification, the system notifies <code>LibraryAPI</code>. And <code>LibraryAPI</code> executes <em>downloadImage:</em> in response. </p>
<p>However, before you implement <em>downloadImage:</em> you must remember to unsubscribe from this notification when your class is deallocated. If you do not properly unsubscribe from a notification your class registered for, a notification might be sent to a deallocated instance. This can result in application crashes.</p>
<p>Add the following method to <em>LibraryAPI.m</em>:</p>
<pre><code>- (void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}
</code></pre><p>When this class is deallocated, it removes itself as an observer from all notifications it had registered for.</p>
<p>There’s one more thing to do. It would probably be a good idea to save the downloaded covers locally so the app won’t need to download the same covers over and over again.</p>
<p>Open <em>PersistencyManager.h</em> and add the following two method prototypes:</p>
<pre><code>- (void)saveImage:(UIImage*)image filename:(NSString*)filename;
- (UIImage*)getImage:(NSString*)filename;
</code></pre><p>And the method implementations to <em>PersistencyManager.m</em>:</p>
<pre><code>- (void)saveImage:(UIImage*)image filename:(NSString*)filename
{
    filename = [NSHomeDirectory() stringByAppendingFormat:@&quot;/Documents/%@&quot;, filename];
    NSData *data = UIImagePNGRepresentation(image);
    [data writeToFile:filename atomically:YES];
}

- (UIImage*)getImage:(NSString*)filename
{
    filename = [NSHomeDirectory() stringByAppendingFormat:@&quot;/Documents/%@&quot;, filename];
    NSData *data = [NSData dataWithContentsOfFile:filename];
    return [UIImage imageWithData:data];
}
</code></pre><p>This code is pretty straightforward. The downloaded images will be saved in the Documents directory, and <code>getImage:</code> will return <code>nil</code> if a matching file is not found in the Documents directory.</p>
<p>Now add the following method to <em>LibraryAPI.m</em>:</p>
<pre><code>- (void)downloadImage:(NSNotification*)notification
{
    // 1
    UIImageView *imageView = notification.userInfo[@&quot;imageView&quot;];
    NSString *coverUrl = notification.userInfo[@&quot;coverUrl&quot;];

    // 2
    imageView.image = [persistencyManager getImage:[coverUrl lastPathComponent]];

    if (imageView.image == nil)
    {
        // 3
        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
            UIImage *image = [httpClient downloadImage:coverUrl];

            // 4
            dispatch_sync(dispatch_get_main_queue(), ^{
                imageView.image = image;
                [persistencyManager saveImage:image filename:[coverUrl lastPathComponent]];
            });
        });
    }    
}
</code></pre><p>Here’s a breakdown of the above code:</p>
<ol>
<li><code>downloadImage</code> is executed via notifications and so the method receives the notification object as a parameter. The <code>UIImageView</code> and image URL are retrieved from the notification.</li>
<li>Retrieve the image from the <code>PersistencyManager</code> if it’s been downloaded previously.</li>
<li>If the image hasn’t already been downloaded, then retrieve it using <code>HTTPClient</code>.</li>
<li>When the download is complete, display the image in the image view and use the <code>PersistencyManager</code> to save it locally.</li>
</ol>
<p>Again, you’re using the Facade pattern to hide the complexity of downloading an image from the other classes. The notification sender doesn’t care if the image came from the web or from the file system.</p>
<p>Build and run your app and check out the beautiful covers inside your <code>HorizontalScroller</code>:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/design-patterns-4-297x320.png" alt="design-patterns-4"></p>
<p>Stop your app and run it again. Notice that there’s no delay in loading the covers because they’ve been saved locally. You can even disconnect from the Internet and your app will work flawlessly. However, there’s one odd bit here: the spinner never stops spinning! What’s going on?</p>
<p>You started the spinner when downloading the image, but you haven’t implemented the logic to stop the spinner once the image is downloaded. You <em>could</em> send out a notification every time an image has been downloaded, but instead, you’ll do that using the other Observer pattern, KVO.</p>
<h3 id="Key-Value-Observing-KVO"><a href="#Key-Value-Observing-KVO" class="headerlink" title="Key-Value Observing (KVO)"></a>Key-Value Observing (KVO)</h3><p>In KVO, an object can ask to be notified of any changes to a specific property; either its own or that of another object. If you’re interested, you can read more about this on <a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html" target="_blank" rel="noopener">Apple’s KVO Programming Guide</a>.</p>
<h3 id="How-to-Use-the-KVO-Pattern"><a href="#How-to-Use-the-KVO-Pattern" class="headerlink" title="How to Use the KVO Pattern"></a>How to Use the KVO Pattern</h3><p>As mentioned above, the KVO mechanism allows an object to observe changes to a property. In your case, you can use KVO to observe changes to the <code>image</code> property of the <code>UIImageView</code> that holds the image.</p>
<p>Open <em>AlbumView.m</em> and add the following code to <code>initWithFrame:albumCover:</code>, just after the [<code>self addSubview:indicator];</code> line:</p>
<pre><code>[coverImage addObserver:self forKeyPath:@&quot;image&quot; options:0 context:nil];
</code></pre><p>This adds <code>self</code>, which is the current class, as an observer for the <code>image</code> property of <code>coverImage</code>. </p>
<p>You also need to unregister as an observer when you’re done. Still in <em>AlbumView.m</em>, add the following code:</p>
<pre><code>- (void)dealloc
{
    [coverImage removeObserver:self forKeyPath:@&quot;image&quot;];
}
</code></pre><p>Finally, add this method:</p>
<pre><code>- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if ([keyPath isEqualToString:@&quot;image&quot;])
    {
        [indicator stopAnimating];
    }
}
</code></pre><p>You must implement this method in every class acting as an observer. The system executes this method every time the observed property changes. In the above code, you stop the spinner when the “image” property changes. This way, when an image is loaded, the spinner will stop spinning.</p>
<p>Build and run your project. The spinner should disappear:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/design-pattern-stage3-287x320.png" alt="design pattern - stage3"></p>
<p><em>Note:</em> Always remember to remove your observers when they’re deallocated, or else your app will crash when the subject tries to send messages to these non-existent observers!</p>
<p>If you play around with your app a bit and terminate it, you’ll notice that the state of your app isn’t saved. The last album you viewed won’t be the default album when the app launches.</p>
<p>To correct this, you can make use of the next pattern on the list: <em>Memento</em>.</p>
<h2 id="The-Memento-Pattern"><a href="#The-Memento-Pattern" class="headerlink" title="The Memento Pattern"></a>The Memento Pattern</h2><p>The memento pattern captures and externalizes an object’s internal state. In other words, it saves your stuff somewhere. Later on, this externalized state can be restored without violating encapsulation; that is, private data remains private.</p>
<h2 id="How-to-Use-the-Memento-Pattern"><a href="#How-to-Use-the-Memento-Pattern" class="headerlink" title="How to Use the Memento Pattern"></a>How to Use the Memento Pattern</h2><p>Add the following two methods to <em>ViewController.m</em>:</p>
<pre><code>- (void)saveCurrentState
{
    // When the user leaves the app and then comes back again, he wants it to be in the exact same state
    // he left it. In order to do this we need to save the currently displayed album.
    // Since it&apos;s only one piece of information we can use NSUserDefaults.
    [[NSUserDefaults standardUserDefaults] setInteger:currentAlbumIndex forKey:@&quot;currentAlbumIndex&quot;];
}

- (void)loadPreviousState
{
    currentAlbumIndex = [[NSUserDefaults standardUserDefaults] integerForKey:@&quot;currentAlbumIndex&quot;];
    [self showDataForAlbumAtIndex:currentAlbumIndex];
}
</code></pre><p><code>saveCurrentState</code> saves the current album index to <code>NSUserDefaults</code> - <code>NSUserDefaults</code> is a standard data store provided by iOS for saving application specific settings and data. </p>
<p><code>loadPreviousState</code> loads the previously saved index. This isn’t quite the full implementation of the Memento pattern, but you’re getting there.</p>
<p>Now, Add the following line to <code>viewDidLoad</code> in <em>ViewController.m</em> before the scroller initialization:</p>
<pre><code>[self loadPreviousState];
</code></pre><p>That loads the previously saved state when the app starts. But where do you save the current state of the app for loading from? You’ll use Notifications to do this. iOS sends a <code>UIApplicationDidEnterBackgroundNotification</code> notification when the app enters the background. You can use this notification to call <code>saveCurrentState</code>. Isn’t that convenient?</p>
<p>Add the following line to the end of <code>viewDidLoad</code>:</p>
<pre><code>[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(saveCurrentState) name:UIApplicationDidEnterBackgroundNotification object:nil];
</code></pre><p>Now, when the app is about to enter the background, the <code>ViewController</code> will automatically save the current state by calling <code>saveCurrentState</code>.</p>
<p>Now, add the following code:</p>
<pre><code>- (void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}
</code></pre><p>This ensures you remove the class as an observer when the <code>ViewController</code> is deallocated.</p>
<p>Build and run your app. Navigate to one of the albums, send the app to the background using <em>Command+Shift+H</em> (if you are on the simulator) and then shut down your app. Relaunch, and check that the previously selected album is centered:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/09/2013-09-02_10-51-27-214x320.png" alt="No Change"></p>
<p>It looks like the album data is correct, but the scroller isn’t centered on the correct album. What gives?</p>
<p>This is what the optional method <code>initialViewIndexForHorizontalScroller:</code> was meant for! Since that method’s not implemented in the delegate, <code>ViewController</code> in this case, the initial view is always set to the first view.</p>
<p>To fix that, add the following code to <em>ViewController.m</em>:</p>
<pre><code>- (NSInteger)initialViewIndexForHorizontalScroller:(HorizontalScroller *)scroller
{
    return currentAlbumIndex;
}
</code></pre><p>Now the <code>HorizontalScroller</code> first view is set to whatever album is indicated by <code>currentAlbumIndex</code>. This is a great way to make sure the app experience remains personal and resumable.</p>
<p>Run your app again. Scroll to an album as before, stop the app, then relaunch to make sure the problem is fixed:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/09/2013-09-02_10-56-59-214x320.png" alt="Showing saved state"></p>
<p>If you look at <code>PersistencyManager</code>‘s <code>init</code>, you’ll notice the album data is hardcoded and recreated every time <code>PersistencyManager</code> is created. But tt’s better to create the list of albums once and store them in a file. How would you save the Album data to a file?</p>
<p>One option is to iterate through <code>Album</code>‘s properties, save them to a plist file and then recreate the <code>Album</code> instances when they’re needed. This isn’t the best option, as it requires you to write specific code depending on what data/properties are there in each class. For example, if you later created a Movie class with different properties, the saving and loading of that data would require new code. </p>
<p>Additionally, you won’t be able to save the private variables for each class instance since they are not accessible to an external class. That’s exactly why Apple created the <em>Archiving</em> mechanism.</p>
<h3 id="Archiving"><a href="#Archiving" class="headerlink" title="Archiving"></a>Archiving</h3><p>One of Apple’s specialized implementations of the Memento pattern is Archiving. This converts an object into a stream that can be saved and later restored without exposing private properties to external classes. You can read more about this functionality in Chapter 16 of the <em>iOS 6 by Tutorials</em> book. Or in <a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/Archiving/Archiving.html" target="_blank" rel="noopener">Apple’s Archives and Serializations Programming Guide</a>.</p>
<h3 id="How-to-Use-Archiving"><a href="#How-to-Use-Archiving" class="headerlink" title="How to Use Archiving"></a>How to Use Archiving</h3><p>First, you need to declare that <code>Album</code> can be archived by conforming to the <code>NSCoding</code> protocol. Open <em>Album.h</em> and change the <code>@interface</code> line as follows:</p>
<pre><code>@interface Album : NSObject 
</code></pre><p>Add the following two methods to <em>Album.m</em>:</p>
<pre><code>- (void)encodeWithCoder:(NSCoder *)aCoder
{
    [aCoder encodeObject:self.year forKey:@&quot;year&quot;];
    [aCoder encodeObject:self.title forKey:@&quot;album&quot;];
    [aCoder encodeObject:self.artist forKey:@&quot;artist&quot;];
    [aCoder encodeObject:self.coverUrl forKey:@&quot;cover_url&quot;];
    [aCoder encodeObject:self.genre forKey:@&quot;genre&quot;];
}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super init];
    if (self)
    {
        _year = [aDecoder decodeObjectForKey:@&quot;year&quot;];
        _title = [aDecoder decodeObjectForKey:@&quot;album&quot;];
        _artist = [aDecoder decodeObjectForKey:@&quot;artist&quot;];
        _coverUrl = [aDecoder decodeObjectForKey:@&quot;cover_url&quot;];
        _genre = [aDecoder decodeObjectForKey:@&quot;genre&quot;];
    }
    return self;
}
</code></pre><p>You call <code>encodeWithCoder:</code> when you archive an instance of this class. Conversely, you call <code>initWithCoder:</code> when you unarchive an instance to create an instance of <code>Album</code>. It’s simple, yet powerful.</p>
<p>Now that the <code>Album</code> class can be archived, add the code that actually saves and loads the list of albums. </p>
<p>Add the following signature (or method prototype) to <em>PersistencyManager.h</em>:</p>
<pre><code>- (void)saveAlbums;
</code></pre><p>This will be the method that’s called to save the albums.</p>
<p>Now, add the method implementation to <em>PersistencyManager.m</em>:</p>
<pre><code>- (void)saveAlbums
{
    NSString *filename = [NSHomeDirectory() stringByAppendingString:@&quot;/Documents/albums.bin&quot;];
    NSData *data = [NSKeyedArchiver archivedDataWithRootObject:albums];
    [data writeToFile:filename atomically:YES];
}
</code></pre><p><code>NSKeyedArchiver</code> archives the album array into a file called <em>albums.bin</em>. </p>
<p>When you archive an object which contains other objects, the archiver automatically tries to recursively archive the child objects and any child objects of the children and so on. In this instance, the archival starts with <code>albums</code>, which is an array of Album instances. Since <code>NSArray</code> and <code>Album</code> both support the <em>NSCopying</em> interface, everything in the array is automatically archived. </p>
<p>Now replace <code>init</code> in <em>PersistencyManager.m</em> with the following code:</p>
<pre><code>- (id)init
{
    self = [super init];
    if (self) {
        NSData *data = [NSData dataWithContentsOfFile:[NSHomeDirectory() stringByAppendingString:@&quot;/Documents/albums.bin&quot;]];
        albums = [NSKeyedUnarchiver unarchiveObjectWithData:data];
        if (albums == nil)
        {
            albums = [NSMutableArray arrayWithArray:
                     @[[[Album alloc] initWithTitle:@&quot;Best of Bowie&quot; artist:@&quot;David Bowie&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_david%20bowie_best%20of%20bowie.png&quot; year:@&quot;1992&quot;],
                     [[Album alloc] initWithTitle:@&quot;It&apos;s My Life&quot; artist:@&quot;No Doubt&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_no%20doubt_its%20my%20life%20%20bathwater.png&quot; year:@&quot;2003&quot;],
                     [[Album alloc] initWithTitle:@&quot;Nothing Like The Sun&quot; artist:@&quot;Sting&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_sting_nothing%20like%20the%20sun.png&quot; year:@&quot;1999&quot;],
                     [[Album alloc] initWithTitle:@&quot;Staring at the Sun&quot; artist:@&quot;U2&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_u2_staring%20at%20the%20sun.png&quot; year:@&quot;2000&quot;],
                     [[Album alloc] initWithTitle:@&quot;American Pie&quot; artist:@&quot;Madonna&quot; coverUrl:@&quot;http://www.coversproject.com/static/thumbs/album/album_madonna_american%20pie.png&quot; year:@&quot;2000&quot;]]];
            [self saveAlbums];
        }
    }
    return self;
}
</code></pre><p>In the new code, <code>NSKeyedUnarchiver</code> loads the album data from the file, if it exists. If it doesn’t exist, it creates the album data and immediately saves it for the next launch of the app. </p>
<p>You’ll also want to save the album data every time the app goes into the background. This might not seem necessary now but what if you later add the option to change album data? Then you’d want this to ensure that all your changes are saved.</p>
<p>Add the following method signature to <em>LibraryAPI.h</em>:</p>
<pre><code>- (void)saveAlbums;
</code></pre><p>Since the main application accesses all services via <code>LibraryAPI</code>, this is how the application will let <code>PersitencyManager</code> know that it needs to save album data.</p>
<p>Now add the method implementation to <em>LibraryAPI.m</em>:</p>
<pre><code>- (void)saveAlbums
{
    [persistencyManager saveAlbums];
}
</code></pre><p>This code simply passes on a call to <code>LibraryAPI</code> to save the albums on to <code>PersistencyMangaer</code>.</p>
<p>Add the following code to the end of <code>saveCurrentState</code> in <em>ViewController.m</em>:</p>
<pre><code>[[LibraryAPI sharedInstance] saveAlbums];
</code></pre><p>And the above code uses <code>LibraryAPI</code> to trigger the saving of album data whenever the ViewController saves its state.</p>
<p>Build your app to check that everything compiles. </p>
<p>Unfortunately, there’s no easy way to check if the data persistency is correct though. You can check the simulator Documents folder for your app in Finder to see that the album data file is created but in order to see any other changes you’d have to add in the ability to change album data.</p>
<p>But instead of changing data, what if you added an option to delete albums you no longer want in your library? Additionally, wouldn’t it be nice to have an undo option if you delete an album by mistake? </p>
<p>This provides a great opportunity to talk about the last pattern on the list: <em>Command</em>.</p>
<h2 id="The-Command-Pattern"><a href="#The-Command-Pattern" class="headerlink" title="The Command Pattern"></a>The Command Pattern</h2><p>The Command design pattern encapsulates a request or action as an object. The encapsulated request is much more flexible than a raw request and can be passed between objects, stored for later, modified dynamically, or placed into a queue. Apple has implemented this pattern using the <em>Target-Action</em> mechanism and <em>Invocation</em>.</p>
<p>You can read more about <a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/CocoaEncyclopedia/Target-Action/Target-Action.html" target="_blank" rel="noopener">Target-Action</a> in Apple’s documentation but Invocation uses the <em>NSInvocation</em> class which contains a target object, a method selector and some parameters. This object can be changed dynamically and executed when needed. It’s a perfect example of the Command pattern in action. It decouples the sending object from the receiving object or objects and can persist a request or a chain of requests.</p>
<h2 id="How-to-Use-the-Command-Pattern"><a href="#How-to-Use-the-Command-Pattern" class="headerlink" title="How to Use the Command Pattern"></a>How to Use the Command Pattern</h2><p>Before you get into the invocation of actions, you need to set up the framework for undoing actions. So you must define the <code>UIToolBar</code> and the <code>NSMutableArray</code> needed for the undo stack. </p>
<p>Add the following code to the class extension in <em>ViewController.m</em> where you defined all the other variables:</p>
<pre><code>UIToolbar *toolbar;
// We will use this array as a stack to push and pop operation for the undo option
NSMutableArray *undoStack;
</code></pre><p>This creates a toolbar which will display the buttons for the new actions, as well as an array to act as the command queue.</p>
<p>Add the following code to the beginning of <code>viewDidLoad:</code> (right before comment #2):</p>
<pre><code>toolbar = [[UIToolbar alloc] init];
UIBarButtonItem *undoItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemUndo target:self action:@selector(undoAction)];
undoItem.enabled = NO;
UIBarButtonItem *space = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
UIBarButtonItem *delete = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemTrash target:self action:@selector(deleteAlbum)];
[toolbar setItems:@[undoItem,space,delete]];
[self.view addSubview:toolbar];
undoStack = [[NSMutableArray alloc] init];
</code></pre><p>The above code creates a toolbar with two buttons and a flexible space between them. It also creates an empty undo stack. The undo button is disabled here because the undo stack starts off empty. </p>
<p>Also, note that the toolbar isn’t initiated with a frame, as the frame size set in <code>viewDidLoad</code> isn’t final. So set the final frame via the following block of code once the view frame is finalized by adding the code to <em>ViewController.m</em>:</p>
<pre><code>- (void)viewWillLayoutSubviews
{
    toolbar.frame = CGRectMake(0, self.view.frame.size.height-44, self.view.frame.size.width, 44);
    dataTable.frame = CGRectMake(0, 130, self.view.frame.size.width, self.view.frame.size.height - 200);
}
</code></pre><p>You’ll add three method to <em>ViewController.m</em> for handling album management actions: add, delete, and undo. </p>
<p>The first is the method for adding a new album:</p>
<pre><code>- (void)addAlbum:(Album*)album atIndex:(int)index
{
    [[LibraryAPI sharedInstance] addAlbum:album atIndex:index];
    currentAlbumIndex = index;
    [self reloadScroller];
}
</code></pre><p>Here you add the album, set it as the current album index, and reload the scroller.</p>
<p>Next comes the delete method:</p>
<pre><code>- (void)deleteAlbum
{
    // 1
    Album *deletedAlbum = allAlbums[currentAlbumIndex];

    // 2
    NSMethodSignature *sig = [self methodSignatureForSelector:@selector(addAlbum:atIndex:)];
    NSInvocation *undoAction = [NSInvocation invocationWithMethodSignature:sig];
    [undoAction setTarget:self];
    [undoAction setSelector:@selector(addAlbum:atIndex:)];
    [undoAction setArgument:&amp;deletedAlbum atIndex:2];
    [undoAction setArgument:¤tAlbumIndex atIndex:3];
    [undoAction retainArguments];

    // 3
    [undoStack addObject:undoAction];

    // 4
    [[LibraryAPI sharedInstance] deleteAlbumAtIndex:currentAlbumIndex];
    [self reloadScroller];

    // 5
    [toolbar.items[0] setEnabled:YES];
}
</code></pre><p>There are some new and exciting features in this code, so consider each commented section below:</p>
<ol>
<li>Get the album to delete.</li>
<li>Define an object of type <code>NSMethodSignature</code> to create the <code>NSInvocation</code>, which will be used to reverse the delete action if the user later decides to undo a deletion. The <code>NSInvocation</code> needs to know three things: The selector (what message to send), the target (who to send the message to) and the arguments of the message. In this example the message sent is delete’s opposite since when you undo a deletion, you need to add back the deleted album.</li>
<li>After the <code>undoAction</code> has been created you add it to the <code>undoStack</code>. This action will be added to the end of the array, just as in a normal stack.</li>
<li>Use <code>LibraryAPI</code> to delete the album from the data structure and reload the scroller.</li>
<li>Since there’s an action in the undo stack, you need to enable the undo button.</li>
</ol>
<p><em>Note:</em> With <code>NSInvocation</code>, you need to keep the following points in mind: </p>
<ul>
<li>The arguments must be passed by pointer.</li>
<li>The arguments start at index 2; indices 0 and 1 are reserved for the target and the selector.</li>
<li>If there’s a chance that the arguments will be deallocated, then you should call <code>retainArguments</code>.</li>
</ul>
<p>Finally, add the method for the undo action:</p>
<pre><code>- (void)undoAction
{
    if (undoStack.count &gt; 0)
    {
        NSInvocation *undoAction = [undoStack lastObject];
        [undoStack removeLastObject];
        [undoAction invoke];
    }

    if (undoStack.count == 0)
    {
        [toolbar.items[0] setEnabled:NO];
    }
}
</code></pre><p>The undo operation “pops” the last object in the stack. This object is always of type NSInvocation and can be invoked by calling … <code>invoke</code>. This invokes the command you created earlier when the album was deleted, and adds the deleted album back to the album list. Since you also deleted the last object in the stack when you “popped” it, you now check to see if the stack is empty. If it is, that means there are no more actions to undo. So you disable the Undo button.</p>
<p>Build and run your app to test out your undo mechanism, delete an album (or two) and hit the Undo button to see it in action:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2013/08/design-pattern-stage4-180x320.png" alt="design pattern - stage4"></p>
<p>This is also a good place to test out whether changes to your album data is retained between sessions. Now, if you delete an album, send the app to the background, and then terminate the app, the next time you start the app the displayed album list should reflect the deletion.</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here?"></a>Where to go from here?</h2><p>Here’s the source code for the finished project: <a href="https://koenig-media.raywenderlich.com/uploads/2013/08/BlueLibrary-final.zip" target="_blank" rel="noopener">BlueLibrary-final</a></p>
<p>There are two other design patterns that didn’t make their way into the app, but are important to mention: <a href="http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/CocoaDesignPatterns.html#//apple_ref/doc/uid/TP40002974-CH6-SW32" target="_blank" rel="noopener">Abstract Factory (aka Class Cluster)</a> and <a href="http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/CocoaDesignPatterns.html#//apple_ref/doc/uid/TP40002974-CH6-SW25" target="_blank" rel="noopener">Chain of Responsibility (aka Responder Chain)</a>. Feel free to read up on these to expand your design pattern horizons.</p>
<p>In this tutorial you saw how to harness the power of iOS design patterns to perform complicated tasks in a very straightforward and loosely coupled manner. You’ve learned a lot of iOS design patterns and concepts: Singleton, MVC, Delegation, Protocols, Facade, Observer, Memento, and Command.</p>
<p>Your final code is loosely coupled, reusable, and readable. If another developer looks at your code, they’ll instantly understand what’s going on and what each class does in your app.</p>
<p>The point isn’t to use a design pattern for every line of code you write. Instead, be aware of design patterns when you consider how to solve a particular problem, especially in the early stages of designing your app. They’ll make your life as a developer much easier and your code a lot better!</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/06/How to Remember the Code You're Learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/06/How to Remember the Code You're Learning/" itemprop="url">How to Remember the Code You're Learning</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-06T12:28:00+08:00">
                2018-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://blog.teamtreehouse.com/retain-code-youre-learning" title="Permalink to How to Remember the Code You&#39;re Learning" target="_blank" rel="noopener">Source</a></p>
<h1 id="How-to-Remember-the-Code-You’re-Learning"><a href="#How-to-Remember-the-Code-You’re-Learning" class="headerlink" title="How to Remember the Code You’re Learning"></a>How to Remember the Code You’re Learning</h1><p>One of the most common questions I get from students is: “What’s the best way to retain what I’m learning?”</p>
<blockquote>
<p><a href="https://twitter.com/guilh" target="_blank" rel="noopener">@guilh</a> I started treehouse and have been going through various HTML &amp; CSS tracks but struggle putting it into practice? Any advice?</p>
<p>— Richard Fogg (@richardpfogg) <a href="https://twitter.com/richardpfogg/statuses/441193591432822784" target="_blank" rel="noopener">March 5, 2014</a></p>
</blockquote>
<p>Students may think they understand the lessons and concepts being taught, but later struggle putting it all into practice. Writing good code takes a lot of time and effort, so the best way to retain the information is through practice and repetition –– easier said than done, right?</p>
<p>Let’s go over some helpful tools and methods you can use to better retain what you’re learning.</p>
<p><img src="http://blog.teamtreehouse.com/wp-content/uploads/2014/03/elephant-Martin-Fisch2.jpg" alt="Elephants"></p>
<p>It’s said elephants have great memories. Why can’t we, too, when it comes to remembering code? (Photo by Flickr user <a href="http://www.flickr.com/photos/marfis75/12474470554/lightbox/" target="_blank" rel="noopener">Martin Fisch</a>)</p>
<h2 id="It’s-Easy-to-Forget-What-You-Don’t-Understand"><a href="#It’s-Easy-to-Forget-What-You-Don’t-Understand" class="headerlink" title="It’s Easy to Forget What You Don’t Understand"></a>It’s Easy to Forget What You Don’t Understand</h2><p>Often, even when you think you have a good grasp of HTML, CSS, or JavaScript concepts and techniques, they’re difficult to put it into practice. And sometimes, no matter how clear the explanations in the videos or tutorials, you can’t get anything to work when you try it later on.</p>
<p>That’s because your interpretation of what’s being taught varies –– you can’t just take the lesson at face value. You need to make sure that your interpretation is right by implementing what you learned.</p>
<p><strong>Free trial on Treehouse:</strong> Do you want to improve your development skills? <a href="https://teamtreehouse.com/subscribe/plans?cid=2122&amp;utm_source=teaching-23189-remember-the-code-youre-learning&amp;trial=yes" target="_blank" rel="noopener">Click here to try a free trial on Treehouse</a>.</p>
<h2 id="Don’t-Just-Watch-or-Read"><a href="#Don’t-Just-Watch-or-Read" class="headerlink" title="Don’t Just Watch or Read"></a>Don’t Just Watch or Read</h2><p>Be an <a href="http://en.wikipedia.org/wiki/Active_learning" target="_blank" rel="noopener">active learner</a>, not a passive learner. It’s difficult to retain information through passive learning. You may think that watching a video or reading a tutorial over and over again is enough to lodge the information in your head forever. While some of it will eventually stick, it’s not the most effective way to learn.</p>
<p>Even though you’re focused on what’s being taught in the lesson, you’re just seeing or reading abstract concepts. To <em>really</em> get it, you need to run into difficulty, make mistakes, then identify and correct them. So converting that knowledge from abstract to practical is important because it’s no longer something someone else has told you.</p>
<p>Start building something right away: A single-page website, a small website component, get involved in a project –– anything. It doesn’t matter what it looks like or how it works as long as you keep doing it while raising the bar, you’ll gradually get better. I promise!</p>
<h2 id="Online-Coding-Tools"><a href="#Online-Coding-Tools" class="headerlink" title="Online Coding Tools"></a>Online Coding Tools</h2><p>These days, online code editors like <a href="http://codepen.io/" target="_blank" rel="noopener">CodePen</a>, <a href="http://jsfiddle.net/" target="_blank" rel="noopener">JSFiddle</a>, or Treehouse’s <a href="http://teamtreehouse.com/workspaces" target="_blank" rel="noopener">Workspaces</a> provide designers and developers a quick way to communally experiment with code. This is a helpful way of implementing a concept you just learned. To ensure you’re getting it into your long-term memory, try coding at different times during the day, without looking anything up beforehand.</p>
<h2 id="Developer-Tools"><a href="#Developer-Tools" class="headerlink" title="Developer Tools"></a>Developer Tools</h2><p>When visiting websites I like, I always use Chrome DevTools (or Mozilla’s Firebug) to inspect the code and see how certain parts of it were built. I’ve learned some neat things doing that. Also, viewing –– or “borrowing” –– another website’s HTML and CSS, then changing it around to build something different can really help when learning to code.</p>
<h2 id="Share-Your-Knowledge"><a href="#Share-Your-Knowledge" class="headerlink" title="Share Your Knowledge"></a>Share Your Knowledge</h2><p>“But I’m not an expert!”</p>
<p>It doesn’t matter. You will always know something that someone else doesn’t know. Plus, you’ll retain more when you synthesize then teach the information and, down the road, it might even establish you as the “expert” in a given topic.</p>
<p>I’m always impressed by those students who have blogs where they write about what they’re learning. It’s no coincidence they are the ones who find successful work in the industry.</p>
<h2 id="Be-Patient-Confident-and-Don’t-Worry-About-Memorizing"><a href="#Be-Patient-Confident-and-Don’t-Worry-About-Memorizing" class="headerlink" title="Be Patient, Confident and Don’t Worry About Memorizing"></a>Be Patient, Confident and Don’t Worry About Memorizing</h2><p>It’s important to be patient because it takes a while to wrap your head around code, but the more you do it, the more it starts clicking.</p>
<p>Don’t worry about memorizing every tag, selector, property or value available. A solid understanding of the concepts –– and a reliable reference –– is more important. I probably don’t know every CSS selector off the top of my head, but I sure know how they work and where to reference them.</p>
<p>For example, If you asked me to code a five-color-stop radial gradient using the old and new syntax, I’d probably go straight to <a href="https://developer.mozilla.org/en-US/" target="_blank" rel="noopener">MDN</a> or use ColorZilla’s <a href="http://www.colorzilla.com/gradient-editor/" target="_blank" rel="noopener">Gradient Generator</a>. By knowing exactly how gradients work, the types of syntax and browser support, I’m able to move through the process much faster.</p>
<p>Finally, to retain new concepts, you need to be confident and refrain from being pessimistic when you struggle. Pessimism leads to giving up.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/05/10 Steps to become a Senior Software Engineer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/05/10 Steps to become a Senior Software Engineer/" itemprop="url">10 Steps to become a Senior Software Engineer</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-05T22:13:00+08:00">
                2018-01-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://alextamoykin.com/10-steps-to-become-a-senior-software-engineer/" title="Permalink to 10 Steps to become a Senior Software Engineer" target="_blank" rel="noopener">Source</a></p>
<h1 id="10-Steps-to-become-a-Senior-Software-Engineer"><a href="#10-Steps-to-become-a-Senior-Software-Engineer" class="headerlink" title="10 Steps to become a Senior Software Engineer"></a>10 Steps to become a Senior Software Engineer</h1><h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><p>Software engineers go through several stages in their careers. They start from a Junior role, then they move to a Mid Level role. Then they become senior. This blog post has 10 steps that help you to become a Senior Software Engineer.</p>
<h2 id="Why-bother"><a href="#Why-bother" class="headerlink" title="Why bother?"></a>Why bother?</h2><ul>
<li>Get paid more! Your salary grows as you level up</li>
<li>Advance in your career. Senior Software Engineers are moving towards Architect, Team Lead, CTO kind of roles</li>
<li>Take on bigger challenges. As you grow you make a bigger impact</li>
</ul>
<h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><p>Software engineering is hard. The industry is always changing and you need to keep up with it. You need to put constant effort and time. There is always more to learn than you can possibly absorb. Many engineers who finish a several month boot camp don’t realize how much more they need to learn on top of it. No worries, there is a clear path to becoming a senior software engineer in almost any area of software development.</p>
<h2 id="Step-0-choose-your-path-and-stick-to-it"><a href="#Step-0-choose-your-path-and-stick-to-it" class="headerlink" title="Step 0: choose your path and stick to it!"></a>Step 0: choose your path and stick to it!</h2><blockquote>
<p>do one thing and do it well - Doug McIlroy : <a href="http://en.wikipedia.org/wiki/Unix_philosophy" title="Unix Philosophy" target="_blank" rel="noopener">Unix Philosophy</a></p>
</blockquote>
<p>I can’t emphasize this enough! It is really important to choose a specialty and a technical stack that you will be working with. Sticking to it and not getting distracted is what will make you a specialist.</p>
<p>It’s an important choice to make. Here is how to do it:</p>
<ul>
<li>Choose your specialty. It’s what you want to do. For example: Web development or Mobile development or DevOps etc.</li>
<li>Choose a technical stack within your specialty. For example: if you chose web development, you’ll need to choose between Ruby on Rails, Python and Django, JavaScript and MEAN etc. If you chose mobile, you’ll need to choose between iOS or Android, etc.</li>
<li>Stick to it and master it.</li>
</ul>
<p>I’m not saying that you shouldn’t get familiar with anything else outside of your main specialty. A well rounded <a href="http://en.wikipedia.org/wiki/T-shaped_skills" title="T-Shaped skills" target="_blank" rel="noopener">T-Shaped</a> Software Engineer knows about other aspects of programming too. Although he/she knows their main specialty extremely well.</p>
<p>Now that you’ve chosen your specialty, you have a lot of things to learn. Take your time. It will take you several years to read all these books and practice necessary skills. Get through this challenge one skill at the time.</p>
<p>I’ll be using the following technical stacks going forward: Ruby on Rails for web development, iOS for mobile development. It is just because I have experience working with it. I can speak to it personally. At the end of the says it’s just a matter of taste. If you choose some other stack, you’ll need to find different books.</p>
<p><img src="//ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;MarketPlace=US&amp;ASIN=020161622X&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL250_&amp;tag=howtoprogramb-20" alt=""><img src="//ir-na.amazon-adsystem.com/e/ir?t=howtoprogramb-20&amp;l=am2&amp;o=1&amp;a=020161622X" alt=""></p>
<h2 id="Step-1-Lay-the-foundations"><a href="#Step-1-Lay-the-foundations" class="headerlink" title="Step 1. Lay the foundations"></a>Step 1. Lay the foundations</h2><p>Read <a href="https://www.amazon.com/gp/product/020161622X/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=howtoprogramb-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=020161622X&amp;linkId=e1b8dec90a96de9b9b9aefeaa655f533" title="The Pragmatic Programmer book" target="_blank" rel="noopener">The Pragmatic Programmer</a> book. It’s a good starting point on the path to software mastery. The book summarizes best high level practices. It’s language / technology agnostic. It doesn’t matter which tech stack you choose, the main principles stay the same.</p>
<h2 id="Step-2-Master-your-programming-language"><a href="#Step-2-Master-your-programming-language" class="headerlink" title="Step 2. Master your programming language"></a>Step 2. Master your programming language</h2><p>You’ll be using many languages day to day depending on the technology stack of your choice. Although, majority of your code will be written in one language. For example: a Ruby on Rails developer uses Ruby primarily. An AngularJS developer uses JavaScript most of the time. Identifying the language of your choice and mastering it is crucial for your career. Learn it, master it! You’ll be using this language every day. Choose your language and read an advance book on it.</p>
<h2 id="Step-3-Learn-your-framework"><a href="#Step-3-Learn-your-framework" class="headerlink" title="Step 3. Learn your framework"></a>Step 3. Learn your framework</h2><p>Choose one, learn it:</p>
<h2 id="Step-4-Become-a-master-of-your-text-editor-IDE"><a href="#Step-4-Become-a-master-of-your-text-editor-IDE" class="headerlink" title="Step 4. Become a master of your text editor / IDE"></a>Step 4. Become a master of your text editor / IDE</h2><p>Again. Choose one, master it and stick to it. If you chose VIM, stay with VIM and become a master of it.</p>
<h2 id="Step-5-Use-your-Version-Control-System-like-a-pro"><a href="#Step-5-Use-your-Version-Control-System-like-a-pro" class="headerlink" title="Step 5. Use your Version Control System like a pro"></a>Step 5. Use your Version Control System like a pro</h2><p>I recommend using Git. Here is the resource that I like: <a href="http://git-scm.com/book" title="The pro git book" target="_blank" rel="noopener">Pro git</a> – free online ebook with a complete breakdown on every aspect of git</p>
<h2 id="Step-6-Commit-to-doing-Test-Driven-Development"><a href="#Step-6-Commit-to-doing-Test-Driven-Development" class="headerlink" title="Step 6. Commit to doing Test Driven Development"></a>Step 6. Commit to doing Test Driven Development</h2><p>Choose a book specific to your tech stack, learn it. Get into a habit of doing it every day. Quality code comes with writing tests.</p>
<h2 id="Step-7-Refactor-as-a-habit"><a href="#Step-7-Refactor-as-a-habit" class="headerlink" title="Step 7. Refactor as a habit"></a>Step 7. Refactor as a habit</h2><p><img src="//ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;MarketPlace=US&amp;ASIN=0201485672&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL250_&amp;tag=howtoprogramb-20" alt=""><img src="//ir-na.amazon-adsystem.com/e/ir?t=howtoprogramb-20&amp;l=am2&amp;o=1&amp;a=0201485672" alt=""></p>
<p>The codebase grows in complexity as you add more functionality. In order to keep your codebase manageable you need to refactor. If you don’t refactor as you go, you’ll soon come to a sad place where even a small change is hard, bugs are inevitable and nobody wants to deal with your messy codebase. Just make your life easier. Don’t delay your refactor. Get into a habit of refactoring. Here is a good book on how to do it: <a href="https://www.amazon.com/gp/product/0201485672/ref=as_li_tl?ie=UTF8&amp;tag=howtoprogramb-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=0201485672&amp;linkId=640c40d8fa8bb2477fe5f78e5652934b" title="Refactoring: Improving the Design of Existing Code" target="_blank" rel="noopener">Refactoring: Improving the Design of Existing Code</a> by Martin Fowler</p>
<p><img src="//ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;MarketPlace=US&amp;ASIN=0321127420&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL250_&amp;tag=howtoprogramb-20" alt=""><img src="//ir-na.amazon-adsystem.com/e/ir?t=howtoprogramb-20&amp;l=am2&amp;o=1&amp;a=0321127420" alt=""></p>
<h2 id="Step-8-Learn-software-architecture"><a href="#Step-8-Learn-software-architecture" class="headerlink" title="Step 8. Learn software architecture"></a>Step 8. Learn software architecture</h2><p>Depending on the stack you choose, find a good book on architecture. Here is one that I recommend by Martin Fowler. It’s called <a href="https://www.amazon.com/gp/product/0321127420/ref=as_li_tl?ie=UTF8&amp;tag=howtoprogramb-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=0321127420&amp;linkId=86ad176f357a761d3741721e634abb7b" title="Enterprise Application Architecture" target="_blank" rel="noopener">Patterns of Enterprise Application Architecture</a></p>
<h2 id="Step-9-Unleash-the-power-of-the-command-line"><a href="#Step-9-Unleash-the-power-of-the-command-line" class="headerlink" title="Step 9. Unleash the power of the command line"></a>Step 9. Unleash the power of the command line</h2><p>The command line can feel intimidating at first. Although, as soon as you learn how to use it, you’ll become a lot more efficient in performing basic tasks. That alone makes you a better developer since you are able to achieve more in less time.</p>
<p>Then you can take it to the next level. Use shell to automate common tasks and build your <a href="https://github.com/fsproru/dotfiles" title="My dotfiles repo as an example" target="_blank" rel="noopener">dotfiles</a>. If you’re working on a Mac or any Linux distribution, learn shell. Here is a good book on it by Mark Bates: <a href="http://conqueringthecommandline.com/book" title="Conquering The Command Line" target="_blank" rel="noopener">Conquering the Command Line</a></p>
<h2 id="Step-10-Code-code-code"><a href="#Step-10-Code-code-code" class="headerlink" title="Step 10. Code code code!"></a>Step 10. Code code code!</h2><p>Every single day. Like in any sport, you need to practice what you learned in order for knowledge to stick.</p>
<h2 id="Takeaway"><a href="#Takeaway" class="headerlink" title="Takeaway"></a>Takeaway</h2><p>Yes, becoming Senior Software Engineer is hard. It takes a lot of time and commitment. Different people learn at different speed, but on average, it takes about 10 years to become a solid senior dev. It’s a big investment in time for a big return.</p>
<p>Software Engineers have the bright future. They are in high demand on the job market. Their salary grows proportionally with their experience. It’s a rapidly growing and a relatively new field. Every day of a software engineer is a challenge. A challenge of changing people’s lives. Go ahead and take on this challenge by becoming a Senior Software Engineer one skill at the time.</p>
<p>Cheers,</p>
<p>Alex</p>
<p><em>Photo by <a href="http://alextamoykin.com/%26quot%3Bhttps%3A/www.flickr.com/photos/lachlanhardy%26quot%3B" target="_blank" rel="noopener">lachlanhardy</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/16/iOS Unit Testing and UI Testing Tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/16/iOS Unit Testing and UI Testing Tutorial/" itemprop="url">iOS Unit Testing and UI Testing Tutorial</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-16T18:24:00+08:00">
                2017-12-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.raywenderlich.com/150073/ios-unit-testing-and-ui-testing-tutorial" title="Permalink to iOS Unit Testing and UI Testing Tutorial" target="_blank" rel="noopener">Source</a></p>
<h1 id="iOS-Unit-Testing-and-UI-Testing-Tutorial"><a href="#iOS-Unit-Testing-and-UI-Testing-Tutorial" class="headerlink" title="iOS Unit Testing and UI Testing Tutorial"></a>iOS Unit Testing and UI Testing Tutorial</h1><p><img src="https://koenig-media.raywenderlich.com/uploads/2017/01/TestinginXcode-feature-250x250.png" alt="iOS Unit Testing - feature"></p>
<p>Make better apps by using iOS Unit Testing!</p>
<p>Writing tests isn’t glamorous, but since tests can keep your sparkling app from turning into a bug-ridden piece of junk, it sure is necessary. If you’re reading this iOS Unit Testing and UI Testing tutorial, you already know you <em>should</em> write tests for your code and UI, but you’re not sure how to test in Xcode. </p>
<p>Maybe you already have a “working” app but no tests set up for it, and you want to be able to test any changes when you extend the app. Maybe you have some tests written, but aren’t sure whether they’re the <em>right</em> tests. Or maybe you’re working on your app now and want to test as you go. </p>
<p>This iOS Unit Testing and UI Testing tutorial shows how to use Xcode’s test navigator to test an app’s model and asynchronous methods, how to fake interactions with library or system objects by using stubs and mocks, how to test UI and performance, and how to use the code coverage tool. Along the way, you’ll pick up some of the vocabulary used by testing ninjas, and by the end of this tutorial you’ll be injecting dependencies into your <em>System Under Test</em> (SUT) with aplomb!</p>
<h2 id="Testing-Testing-…"><a href="#Testing-Testing-…" class="headerlink" title="Testing, Testing …"></a>Testing, Testing …</h2><h3 id="What-to-Test"><a href="#What-to-Test" class="headerlink" title="What to Test?"></a>What to Test?</h3><p>Before writing any tests, it’s important to start with the basics: what do you need to test? If your goal is to extend an existing app, you should first write tests for <em>any component you plan to change</em>.</p>
<p>More generally, tests should cover:</p>
<ul>
<li>Core functionality: model classes and methods, and their interactions with the controller</li>
<li>The most common UI workflows</li>
<li>Boundary conditions</li>
<li>Bug fixes</li>
</ul>
<h3 id="First-Things-FIRST-Best-Practices-for-Testing"><a href="#First-Things-FIRST-Best-Practices-for-Testing" class="headerlink" title="First Things FIRST: Best Practices for Testing"></a>First Things FIRST: Best Practices for Testing</h3><p>The acronym FIRST describes a concise set of criteria for effective unit tests. Those criteria are:</p>
<ul>
<li><em>Fast</em>: Tests should run quickly, so people won’t mind running them.</li>
<li><em>Independent/Isolated</em>: Tests should not do setup or teardown for one another.</li>
<li><em>Repeatable</em>: You should obtain the same results every time you run a test. External data providers and concurrency issues could cause intermittent failures.</li>
<li><em>Self-validating</em>: Tests should be fully automated; the output should be either “pass” or “fail”, rather than a programmer’s interpretation of a log file.</li>
<li><em>Timely</em>: Ideally, tests should be written just before you write the production code they test.</li>
</ul>
<p>Following the FIRST principles will keep your tests clear and helpful, instead of turning into roadblocks for your app.</p>
<h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><p>Download, unzip, open and inspect the <a href="https://koenig-media.raywenderlich.com/uploads/2016/12/Starters.zip" target="_blank" rel="noopener">starter projects</a> BullsEye and HalfTunes.</p>
<p><em>BullsEye</em> is based on a sample app in <a href="https://www.raywenderlich.com/store/ios-apprentice" target="_blank" rel="noopener"><em>iOS Apprentice</em></a>; I’ve extracted the game logic into a <code>BullsEyeGame</code> class and added an alternative game style. </p>
<p>In the lower-right corner there’s a segmented control to let the user select the game style: either <em>Slide</em>, to move the slider to get as close as possible to the target value, or <em>Type</em>, to guess where the slider position is. The control’s action also stores the user’s game style choice as a user default.</p>
<p><em>HalfTunes</em> is the sample app from our <a href="https://www.raywenderlich.com/110458/nsurlsession-tutorial-getting-started" target="_blank" rel="noopener">NSURLSession Tutorial</a>, updated to Swift 3. Users can query the iTunes API for songs, then download and play song snippets.</p>
<p>Let’s start testing!</p>
<h2 id="Unit-Testing-in-Xcode"><a href="#Unit-Testing-in-Xcode" class="headerlink" title="Unit Testing in Xcode"></a>Unit Testing in Xcode</h2><h3 id="Creating-a-Unit-Test-Target"><a href="#Creating-a-Unit-Test-Target" class="headerlink" title="Creating a Unit Test Target"></a>Creating a Unit Test Target</h3><p>The <em>Xcode Test Navigator</em> provides the easiest way to work with tests; you’ll use it to create test targets and run tests on your app.</p>
<p>Open the <em>BullsEye</em> project and hit <em>Command-5</em> to open its test navigator.</p>
<p>Click the <em>+</em> button in the lower-left corner, then select <em>New Unit Test Target…</em> from the menu:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/TestNavigator1.png" alt="iOS Unit Testing: Test Navigator"></p>
<p>Accept the default name <em>BullsEyeTests</em>. When the <em>test bundle</em> appears in the test navigator, click it to open it in the editor. If BullsEyeTests doesn’t appear automatically, trouble-shoot by clicking one of the other navigators, then returning to the test navigator.</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/TestNavigator2-650x290.png" alt="iOS Unit Testing: Template"></p>
<p>The template imports <code>XCTest</code> and defines a <code>BullsEyeTests</code> subclass of <code>XCTestCase</code>, with <code>setup()</code>, <code>tearDown()</code> and example test methods.</p>
<p>There are three ways to run the test class:</p>
<ol>
<li><em>ProductTest</em> or <em>Command-U</em>. This actually runs <em>all</em> test classes.</li>
<li>Click the arrow button in the test navigator.</li>
<li>Click the diamond button in the gutter.</li>
</ol>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/TestNavigator3-480x81.png" alt="iOS Unit Testing: Running Tests"></p>
<p>You can also run an individual test method by clicking its diamond, either in the test navigator or in the gutter.</p>
<p>Try the different ways to run the tests to get a feeling for how long it takes and what it looks like. The sample tests don’t do anything yet, so they’ll run really fast! </p>
<p>When all the tests succeed, the diamonds will turn green and show check marks. Click the gray diamond at the end of <code>testPerformanceExample()</code> to open the Performance Result:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/TestNavigator4-650x341.png" alt="iOS Unit Testing: Performance Results"></p>
<p>You don’t need <code>testPerformanceExample()</code>, so delete it.</p>
<h3 id="Using-XCTAssert-to-Test-Models"><a href="#Using-XCTAssert-to-Test-Models" class="headerlink" title="Using XCTAssert to Test Models"></a>Using XCTAssert to Test Models</h3><p>First, you’ll use XCTAssert to test a core function of BullsEye’s model: does a <code>BullsEyeGame</code> object correctly calculate the score for a round?</p>
<p>In <em>BullsEyeTests.swift</em>, add this line just below the <code>import</code> statement:</p>
<pre><code>@testable import BullsEye
</code></pre><p>This gives the unit tests access to the classes and methods in BullsEye.</p>
<p>At the top of the <code>BullsEyeTests</code> class, add this property:</p>
<pre><code>var gameUnderTest: BullsEyeGame!
</code></pre><p>Create and start a new <code>BullsEyeGame</code> object in <code>setup()</code>, <em>after</em> the call to <code>super</code>:</p>
<pre><code>gameUnderTest = BullsEyeGame()
gameUnderTest.startNewGame()
</code></pre><p>This creates an SUT (System Under Test) object at the class level, so all the tests in this test class can access the SUT object’s properties and methods.</p>
<p>Here, you also call the game’s <code>startNewGame</code> method, which creates a <code>targetValue</code>. Many of your tests will use <code>targetValue</code>, to test that the game calculates the score correctly.</p>
<p>Before you forget, <em>release</em> your SUT object in <code>tearDown()</code>, <em>before</em> the call to <code>super</code>:</p>
<pre><code>gameUnderTest = nil
</code></pre><p><em>Note:</em> It’s good practice to create the SUT in <code>setup()</code> and release it in <code>tearDown()</code>, to ensure every test starts with a clean slate. For more discussion, check out <a href="http://qualitycoding.org/teardown/" target="_blank" rel="noopener">Jon Reid’s post</a> on the subject.</p>
<p>Now you’re ready to write your first test! </p>
<p>Replace <code>testExample()</code> with the following code:</p>
<pre><code>// XCTAssert to test model
func testScoreIsComputed() {
  // 1. given
  let guess = gameUnderTest.targetValue + 5

  // 2. when
  _ = gameUnderTest.check(guess: guess)

  // 3. then
  XCTAssertEqual(gameUnderTest.scoreRound, 95, &quot;Score computed from guess is wrong&quot;)
}
</code></pre><p>A test method’s name always begins with <code>test</code>, followed by a description of what it tests.</p>
<p>It’s good practice to format the test into <em>given</em>, <em>when</em> and <em>then</em> sections:</p>
<ol>
<li>In the <em>given</em> section, set up any values needed: in this example, you create a <code>guess</code> value so you can specify how much it differs from <code>targetValue</code>.</li>
<li>In the <em>when</em> section, execute the code being tested: call <code>gameUnderTest.check(_:)</code>.</li>
<li>In the <em>then</em> section, assert the result you expect (in this case, <code>gameUnderTest.scoreRound</code> is 100 – 5) with a message that prints if the test <em>fails</em>.</li>
</ol>
<p>Run the test by clicking the diamond icon in the gutter or in the test navigator. The app will build and run, and the diamond icon will change to a green checkmark!</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/givenWhenThen-433x320.png" alt="iOS Unit Testing givenWhenThen"></p>
<p><em>Note:</em> The <em>Given-When-Then</em> structure of a test originated with Behavior Driven Development (BDD) as a client-friendly, low-jargon nomenclature. Alternative naming systems are <em>Arrange-Act-Assert</em> and <em>Assemble-Activate-Assert</em>.</p>
<h3 id="Debugging-a-Test"><a href="#Debugging-a-Test" class="headerlink" title="Debugging a Test"></a>Debugging a Test</h3><p>There’s a bug built into <code>BullsEyeGame</code> on purpose, so now you’ll practice finding it. To see the bug in action, rename <code>testScoreIsComputed</code> to <code>testScoreIsComputedWhenGuessGTTarget</code>, then copy-paste-edit it to create <code>testScoreIsComputedWhenGuessLTTarget</code>.</p>
<p>In this test, <em>subtract</em> 5 from <code>targetValue</code> in the <em>given</em> section. Leave everything else the same:</p>
<pre><code>func testScoreIsComputedWhenGuessLTTarget() {
  // 1. given
  let guess = gameUnderTest.targetValue - 5

  // 2. when
  _ = gameUnderTest.check(guess: guess)

  // 3. then
  XCTAssertEqual(gameUnderTest.scoreRound, 95, &quot;Score computed from guess is wrong&quot;)
}
</code></pre><p>The difference between <code>guess</code> and <code>targetValue</code> is still 5, so the score should still be 95.</p>
<p>In the breakpoint navigator, add a <em>Test Failure Breakpoint</em>; this will stop the test run when a test method posts a failure assertion.</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/AddTestFailureBreakpoint.png" alt="iOS Unit Testing: Adding a Test Failure Breakpoint"></p>
<p>Run your test: it should stop at the <code>XCTAssertEqual</code> line with a Test Failure. </p>
<p>Inspect <code>gameUnderTest</code> and <code>guess</code> in the debug console:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/TestFailure-650x353.png" alt="iOS Unit Testing: Viewing a Test Failure"></p>
<p><code>guess</code> is <code>targetValue - 5</code> but <code>scoreRound</code> is 105, not 95!</p>
<p>To investigate further, use the normal debugging process: set a breakpoint at the <em>when</em> statement and also one in <em>BullsEyeGame.swift</em>, in <code>check(_:)</code>, where it creates <code>difference</code>. Then run the test again, and step-over the <code>let difference</code> statement to inspect the value of <code>difference</code> in the app:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/DebugConsole.png" alt="iOS Unit Testing: Debug Console"></p>
<p>The problem is that <code>difference</code> is negative, so the score is <em>100 – (-5)</em>; the fix is to use the <em>absolute value</em> of difference. In <code>check(_:)</code>, uncomment the correct line and delete the incorrect one.</p>
<p>Remove the two breakpoints and run the test again to confirm that it now succeeds.</p>
<h3 id="Using-XCTestExpectation-to-Test-Asynchronous-Operations"><a href="#Using-XCTestExpectation-to-Test-Asynchronous-Operations" class="headerlink" title="Using XCTestExpectation to Test Asynchronous Operations"></a>Using XCTestExpectation to Test Asynchronous Operations</h3><p>Now that you’ve learned how to test models and debug test failures, let’s move on to using <code>XCTestExpectation</code> to test network operations.</p>
<p>Open the <em>HalfTunes</em> project: it uses <code>URLSession</code> to query the iTunes API and download song samples. Suppose you want to modify it to use <a href="https://www.raywenderlich.com/121540/alamofire-tutorial-getting-started" target="_blank" rel="noopener">AlamoFire</a> for network operations. To see if anything breaks, you should write tests for the network operations and run them before and after you change the code.</p>
<p><code>URLSession</code> methods are <em>asynchronous</em>: they return right away, but don’t really finish running until some time later. To test asynchronous methods, you use <code>XCTestExpectation</code> to make your test wait for the asynchronous operation to complete.</p>
<p>Asynchronous tests are usually slow, so you should keep them separate from your faster unit tests. </p>
<p>Select <em>New Unit Test Target…</em> from the <em>+</em> menu and name it <em>HalfTunesSlowTests</em>. Import the HalfTunes app just below the <code>import</code> statement:</p>
<pre><code>@testable import HalfTunes
</code></pre><p>The tests in this class will all use the default session to send requests to Apple’s servers, so declare a <code>sessionUnderTest</code> object, create it in <code>setup()</code> and release it in <code>tearDown()</code>:</p>
<pre><code>var sessionUnderTest: URLSession!

override func setUp() {
  super.setUp()
  sessionUnderTest = URLSession(configuration: URLSessionConfiguration.default)
}

override func tearDown() {
  sessionUnderTest = nil
  super.tearDown()
}
</code></pre><p>Replace <code>testExample()</code> with your asynchronous test:</p>
<pre><code>// Asynchronous test: success fast, failure slow
func testValidCallToiTunesGetsHTTPStatusCode200() {
  // given
  let url = URL(string: &quot;https://itunes.apple.com/search?media=music&amp;entity=song&amp;term=abba&quot;)
  // 1
  let promise = expectation(description: &quot;Status code: 200&quot;)

  // when
  let dataTask = sessionUnderTest.dataTask(with: url!) { data, response, error in
    // then
    if let error = error {
      XCTFail(&quot;Error: (error.localizedDescription)&quot;)
      return
    } else if let statusCode = (response as? HTTPURLResponse)?.statusCode {
      if statusCode == 200 {
        // 2
        promise.fulfill()
      } else {
        XCTFail(&quot;Status code: (statusCode)&quot;)
      }
    }
  }
  dataTask.resume()
  // 3
  waitForExpectations(timeout: 5, handler: nil)
}
</code></pre><p>This test checks to see that sending a valid query to iTunes returns a 200 status code. Most of the code is the same as what you’d write in the app, with these additional lines:</p>
<ol>
<li><code>expectation(_:)</code> returns an <code>XCTestExpectation</code> object, which you store in <code>promise</code>. Other commonly used names for this object are <code>expectation</code> and <code>future</code>. The <code>description</code> parameter describes what you expect to happen.</li>
<li>To match the <code>description</code>, you call <code>promise.fulfill()</code> in the success condition closure of the asynchronous method’s completion handler. </li>
<li><code>waitForExpectations(_:handler:)</code> keeps the test running until all expectations are fulfilled, or the <code>timeout</code> interval ends, whichever happens first.</li>
</ol>
<p>Run the test. If you’re connected to the internet, the test should take about a second to succeed after the app starts to load in the simulator.</p>
<h3 id="Fail-Faster"><a href="#Fail-Faster" class="headerlink" title="Fail Faster"></a>Fail Faster</h3><p>Failure hurts, but it doesn’t have to take forever. Here you’ll address how to quickly find out if your tests fail, saving time that could be better wasted on Facebook. :]</p>
<p>To modify your test so the asynchronous operation fails, simply delete the ‘s’ from “itunes” in the URL:</p>
<pre><code>let url = URL(string: &quot;https://itune.apple.com/search?media=music&amp;entity=song&amp;term=abba&quot;)
</code></pre><p>Run the test: it fails, but it takes the full timeout interval! This is because its expectation is that the request succeeded, and that’s where you called <code>promise.fulfill()</code>. Since the request fails, the test finishes only when the timeout expires. </p>
<p>You can make this test fail faster by changing its expectation: instead of waiting for the request to succeed, wait only until the asynchronous method’s completion handler is invoked. This happens as soon as the app receives a response — either OK or error — from the server, which fulfills the expectation. Your test can then check whether the request succeeded.</p>
<p>To see how this works, you’ll create a new test. First, fix this test by undoing the change to <code>url</code>, then add the following test to your class:</p>
<pre><code>// Asynchronous test: faster fail
func testCallToiTunesCompletes() {
  // given
  let url = URL(string: &quot;https://itune.apple.com/search?media=music&amp;entity=song&amp;term=abba&quot;)
  // 1
  let promise = expectation(description: &quot;Completion handler invoked&quot;)
  var statusCode: Int?
  var responseError: Error?

  // when
  let dataTask = sessionUnderTest.dataTask(with: url!) { data, response, error in
    statusCode = (response as? HTTPURLResponse)?.statusCode
    responseError = error
    // 2
    promise.fulfill()
  }
  dataTask.resume()
  // 3
  waitForExpectations(timeout: 5, handler: nil)

  // then
  XCTAssertNil(responseError)
  XCTAssertEqual(statusCode, 200)
}
</code></pre><p>The key thing here is that simply entering the completion handler fulfills the expectation, and this takes about a second to happen. If the request fails, the <code>then</code> assertions fail.</p>
<p>Run the test: it should now take about a second to fail, and it fails because the request failed, not because the test run exceeded <code>timeout</code>.</p>
<p>Fix the <code>url</code>, then run the test again to confirm that it now succeeds.</p>
<h2 id="Faking-Objects-and-Interactions"><a href="#Faking-Objects-and-Interactions" class="headerlink" title="Faking Objects and Interactions"></a>Faking Objects and Interactions</h2><p>Asynchronous tests give you confidence that your code <em>generates</em> correct input to an asynchronous API. You might also want to test that your code works correctly when it <em>receives</em> input from a <code>URLSession</code>, or that it correctly updates <code>UserDefaults</code> or a CloudKit database.</p>
<p>Most apps interact with system or library objects — objects you don’t control — and tests that interact with these objects can be slow and unrepeatable, violating two of the FIRST principles. Instead, you can <em>fake</em> the interactions by getting input from <em>stubs</em> or by updating <em>mock</em> objects.</p>
<p>Employ fakery when your code has a <em>dependency</em> on a system or library object — create a fake object to play that part and <em>inject</em> this fake into your code. <a href="https://www.objc.io/issues/15-testing/dependency-injection/" target="_blank" rel="noopener"><em>Dependency Injection</em> by Jon Reid</a> describes several ways to do this.</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/fake-433x320.png" alt="fake"></p>
<h3 id="Fake-Input-From-Stub"><a href="#Fake-Input-From-Stub" class="headerlink" title="Fake Input From Stub"></a>Fake Input From Stub</h3><p>In this test, you’ll check that the app’s <code>updateSearchResults(_:)</code> method correctly parses data downloaded by the session by checking that <code>searchResults.count</code> is correct. The SUT is the view controller, and you’ll fake the session with stubs and some pre-downloaded data.</p>
<p>Select <em>New Unit Test Target…</em> from the <em>+</em> menu and name it <em>HalfTunesFakeTests</em>. Import the HalfTunes app just below the <code>import</code> statement:</p>
<pre><code>@testable import HalfTunes
</code></pre><p>Declare the SUT, create it in <code>setup()</code> and release it in <code>tearDown()</code>:</p>
<pre><code>var controllerUnderTest: SearchViewController!

override func setUp() {
  super.setUp()
  controllerUnderTest = UIStoryboard(name: &quot;Main&quot;, 
      bundle: nil).instantiateInitialViewController() as! SearchViewController!
}

override func tearDown() {
  controllerUnderTest = nil
  super.tearDown()
}
</code></pre><p><em>Note:</em> The SUT is the view controller because HalfTunes has a <em>massive</em> view controller problem — all the work is done in SearchViewController.swift. <a href="http://williamboles.me/networking-with-nsoperation-as-your-wingman/" target="_blank" rel="noopener">Moving the networking code into separate modules</a> would reduce this problem, and also make testing easier.</p>
<p>Next, you’ll need some sample JSON data that your fake session will provide to your test. Just a few items will do, so to limit your download results in iTunes append <code>&amp;limit=3</code> to the URL string: </p>
<pre><code>https://itunes.apple.com/search?media=music&amp;entity=song&amp;term=abba&amp;limit=3
</code></pre><p>Copy this URL and paste it into a browser. This downloads a file named <em>1.txt</em> or similar. Preview it to confirm it’s a JSON file, then rename it <em>abbaData.json</em> and add the file to the <em>HalfTunesFakeTests</em> group.</p>
<p>The HalfTunes project contains the supporting file <em>DHURLSessionMock.swift</em>. This defines a simple protocol named <code>DHURLSession</code>, with methods (stubs) to create a data task with either a <code>URL</code> or a <code>URLRequest</code>. It also defines <code>URLSessionMock</code> which conforms to this protocol, with initializers that let you create a mock <code>URLSession</code> object with your choice of data, response and error.</p>
<p>Set up the fake data and response, and create the fake session object, in <code>setup()</code> after the statement that creates the SUT:</p>
<pre><code>let testBundle = Bundle(for: type(of: self))
let path = testBundle.path(forResource: &quot;abbaData&quot;, ofType: &quot;json&quot;)
let data = try? Data(contentsOf: URL(fileURLWithPath: path!), options: .alwaysMapped)

let url = URL(string: &quot;https://itunes.apple.com/search?media=music&amp;entity=song&amp;term=abba&quot;)
let urlResponse = HTTPURLResponse(url: url!, statusCode: 200, httpVersion: nil, headerFields: nil)

let sessionMock = URLSessionMock(data: data, response: urlResponse, error: nil)
</code></pre><p>At the end of <code>setup()</code>, inject the fake session into the app as a property of the SUT:</p>
<pre><code>controllerUnderTest.defaultSession = sessionMock
</code></pre><p><em>Note:</em> You’ll use the fake session directly in your test, but this shows you how to inject it so that your future tests can call SUT methods that use the view controller’s <code>defaultSession</code> property.</p>
<p>Now you’re ready to write the test that checks whether calling <code>updateSearchResults(_:)</code> parses the fake data. Replace <code>testExample()</code> with the following:</p>
<pre><code>// Fake URLSession with DHURLSession protocol and stubs
func test_UpdateSearchResults_ParsesData() {
  // given
  let promise = expectation(description: &quot;Status code: 200&quot;)

  // when
  XCTAssertEqual(controllerUnderTest?.searchResults.count, 0, &quot;searchResults should be empty before the data task runs&quot;)
  let url = URL(string: &quot;https://itunes.apple.com/search?media=music&amp;entity=song&amp;term=abba&quot;)
  let dataTask = controllerUnderTest?.defaultSession.dataTask(with: url!) {
    data, response, error in
    // if HTTP request is successful, call updateSearchResults(_:) which parses the response data into Tracks
    if let error = error {
      print(error.localizedDescription)
    } else if let httpResponse = response as? HTTPURLResponse {
      if httpResponse.statusCode == 200 {
        promise.fulfill()
        self.controllerUnderTest?.updateSearchResults(data)
      }
    }
  }
  dataTask?.resume()
  waitForExpectations(timeout: 5, handler: nil)

  // then
  XCTAssertEqual(controllerUnderTest?.searchResults.count, 3, &quot;Didn&apos;t parse 3 items from fake response&quot;)
}
</code></pre><p>You still have to write this as an asynchronous test because the stub is pretending to be an asynchronous method.</p>
<p>The <em>when</em> assertion is that <code>searchResults</code> is empty before the data task runs — this should be true, because you created a completely new SUT in <code>setup()</code>.</p>
<p>The fake data contains the JSON for three <code>Track</code> objects, so the <em>then</em> assertion is that the view controller’s <code>searchResults</code> array contains three items.</p>
<p>Run the test. It should succeed pretty quickly, because there isn’t any real network connection!</p>
<h3 id="Fake-Update-to-Mock-Object"><a href="#Fake-Update-to-Mock-Object" class="headerlink" title="Fake Update to Mock Object"></a>Fake Update to Mock Object</h3><p>The previous test used a <em>stub</em> to provide input from a fake object. Next, you’ll use a <em>mock object</em> to test that your code correctly updates <code>UserDefaults</code>.</p>
<p>Reopen the <em>BullsEye</em> project. The app has two game styles: the user either moves the slider to match the target value or guesses the target value from the slider position. A segmented control in the lower-right corner switches the game style and updates the <code>gameStyle</code> user default to match.</p>
<p>Your next test will check that the app correctly updates the <code>gameStyle</code> user default.</p>
<p>In the test navigator, click on <em>New Unit Test Target…</em> and name it <em>BullsEyeMockTests</em>. Add the following below the <code>import</code> statement:</p>
<pre><code>@testable import BullsEye

class MockUserDefaults: UserDefaults {
  var gameStyleChanged = 0
  override func set(_ value: Int, forKey defaultName: String) {
    if defaultName == &quot;gameStyle&quot; {
      gameStyleChanged += 1
    }
  }
}
</code></pre><p><code>MockUserDefaults</code> overrides the <code>set(_:forKey:)</code> method to increment the <code>gameStyleChanged</code> flag. Often you’ll see similar tests that set a <code>Bool</code> variable, but incrementing an <code>Int</code> gives you more flexibility — for example, your test could check that the method is called exactly once.</p>
<p>Declare the SUT and the mock object in <code>BullsEyeMockTests</code>:</p>
<pre><code>var controllerUnderTest: ViewController!
var mockUserDefaults: MockUserDefaults!
</code></pre><p>In <code>setup()</code>, create the SUT and the mock object, then inject the mock object as a property of the SUT:</p>
<pre><code>controllerUnderTest = UIStoryboard(name: &quot;Main&quot;, bundle: nil).instantiateInitialViewController() as! ViewController!
mockUserDefaults = MockUserDefaults(suiteName: &quot;testing&quot;)!
controllerUnderTest.defaults = mockUserDefaults
</code></pre><p>Release the SUT and the mock object in <code>tearDown()</code>:</p>
<pre><code>controllerUnderTest = nil
mockUserDefaults = nil
</code></pre><p>Replace <code>testExample()</code> with this:</p>
<pre><code>// Mock to test interaction with UserDefaults
func testGameStyleCanBeChanged() {
  // given
  let segmentedControl = UISegmentedControl()

  // when
  XCTAssertEqual(mockUserDefaults.gameStyleChanged, 0, &quot;gameStyleChanged should be 0 before sendActions&quot;)
  segmentedControl.addTarget(controllerUnderTest, 
      action: #selector(ViewController.chooseGameStyle(_:)), for: .valueChanged)
  segmentedControl.sendActions(for: .valueChanged)

  // then
  XCTAssertEqual(mockUserDefaults.gameStyleChanged, 1, &quot;gameStyle user default wasn&apos;t changed&quot;)
}
</code></pre><p>The <em>when</em> assertion is that the <code>gameStyleChanged</code> flag is 0 before the test method “taps” the segmented control. So if the <em>then</em> assertion is also true, it means <code>set(_:forKey:)</code> was called exactly once.</p>
<p>Run the test; it should succeed.</p>
<h2 id="UI-Testing-in-Xcode"><a href="#UI-Testing-in-Xcode" class="headerlink" title="UI Testing in Xcode"></a>UI Testing in Xcode</h2><p>Xcode 7 introduced UI testing, which lets you create a UI test by recording interactions with the UI. UI testing works by finding an app’s UI objects with queries, synthesizing events, then sending them to those objects. The API enables you to examine a UI object’s properties and state in order to compare them against the expected state.</p>
<p>In the <em>BullsEye</em> project’s test navigator, add a new <em>UI Test Target</em>. Check that <em>Target to be Tested</em> is <em>BullsEye</em>, then accept the default name <em>BullsEyeUITests</em>.</p>
<p>Add this property at the top of the <code>BullsEyeUITests</code> class:</p>
<pre><code>var app: XCUIApplication!
</code></pre><p>In <code>setup()</code>, replace the statement <code>XCUIApplication().launch()</code> with the following:</p>
<pre><code>app = XCUIApplication()
app.launch()
</code></pre><p>Change the name of <code>testExample()</code> to <code>testGameStyleSwitch()</code>.</p>
<p>Open a new line in <code>testGameStyleSwitch()</code> and click the red <em>Record</em> button at the bottom of the editor window:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/UITest.png" alt="iOS Unit Testing: Recording a UI Test"></p>
<p>When the app appears in the simulator, tap the <em>Slide</em> segment of the game style switch and the top label. Then click the Xcode Record button to stop the recording.</p>
<p>You now have the following three lines in <code>testGameStyleSwitch()</code>:</p>
<pre><code>let app = XCUIApplication()
app.buttons[&quot;Slide&quot;].tap()
app.staticTexts[&quot;Get as close as you can to: &quot;].tap()
</code></pre><p>If there are any other statements, delete them.</p>
<p>Line 1 duplicates the property you created in <code>setup()</code> and you don’t need to tap anything yet, so also delete the first line and the <code>.tap()</code> at the end of lines 2 and 3. Open the little menu next to [<code>&quot;Slide&quot;]</code> and select <code>segmentedControls.buttons[&quot;Slide&quot;]</code>. </p>
<p>So what you have is:</p>
<pre><code>app.segmentedControls.buttons[&quot;Slide&quot;]
app.staticTexts[&quot;Get as close as you can to: &quot;]
</code></pre><p>Alter this to create a <em>given</em> section:</p>
<pre><code>// given
let slideButton = app.segmentedControls.buttons[&quot;Slide&quot;]
let typeButton = app.segmentedControls.buttons[&quot;Type&quot;]
let slideLabel = app.staticTexts[&quot;Get as close as you can to: &quot;]
let typeLabel = app.staticTexts[&quot;Guess where the slider is: &quot;]
</code></pre><p>Now that you have names for the two buttons and the two possible top labels, add the following:</p>
<pre><code>// then
if slideButton.isSelected {
  XCTAssertTrue(slideLabel.exists)
  XCTAssertFalse(typeLabel.exists)

  typeButton.tap()
  XCTAssertTrue(typeLabel.exists)
  XCTAssertFalse(slideLabel.exists)
} else if typeButton.isSelected {
  XCTAssertTrue(typeLabel.exists)
  XCTAssertFalse(slideLabel.exists)

  slideButton.tap()
  XCTAssertTrue(slideLabel.exists)
  XCTAssertFalse(typeLabel.exists)
}
</code></pre><p>This checks to see whether the correct label exists when each button is selected or tapped. Run the test — all the assertions should succeed.</p>
<h2 id="Performance-Testing"><a href="#Performance-Testing" class="headerlink" title="Performance Testing"></a>Performance Testing</h2><p>From <a href="https://developer.apple.com/library/prerelease/content/documentation/DeveloperTools/Conceptual/testing_with_xcode/chapters/04-writing_tests.html#//apple_ref/doc/uid/TP40014132-CH4-SW8" target="_blank" rel="noopener">Apple’s documentation</a>: <em>A performance test takes a block of code that you want to evaluate and runs it ten times, collecting the average execution time and the standard deviation for the runs. The averaging of these individual measurements form a value for the test run that can then be compared against a baseline to evaluate success or failure.</em></p>
<p>It’s very simple to write a performance test: you just put the code you want to measure into the closure of the <code>measure()</code> method. </p>
<p>To see this in action, reopen the <em>HalfTunes</em> project and, in <em>HalfTunesFakeTests</em>, replace <code>testPerformanceExample()</code> with the following test:</p>
<pre><code>// Performance 
func test_StartDownload_Performance() {
  let track = Track(name: &quot;Waterloo&quot;, artist: &quot;ABBA&quot;, 
      previewUrl: &quot;http://a821.phobos.apple.com/us/r30/Music/d7/ba/ce/mzm.vsyjlsff.aac.p.m4a&quot;)
  measure {
    self.controllerUnderTest?.startDownload(track)
  }
}
</code></pre><p>Run the test, then click the icon that appears next to the end of the <code>measure()</code> closure to see the statistics.</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/PerformanceResult-650x228.png" alt="iOS Unit Testing: Viewing a Performance Result"></p>
<p>Click <em>Set Baseline</em>, then run the performance test again and view the result — it might be better or worse than the baseline. The <em>Edit</em> button lets you reset the baseline to this new result.</p>
<p>Baselines are stored per device configuration, so you can have the same test executing on several different devices, and have each maintain a different baseline dependent upon the specific configuration’s processor speed, memory, etc.</p>
<p>Anytime you make changes to an app that might impact the performance of the method being tested, run the performance test again to see how it compares to the baseline.</p>
<h2 id="Code-Coverage"><a href="#Code-Coverage" class="headerlink" title="Code Coverage"></a>Code Coverage</h2><p>The code coverage tool tells you what app code is actually being run by your tests, so you know what parts of the app code aren’t (yet) being tested.</p>
<p><em>Note:</em> Should you run performance tests while code coverage is enabled? <a href="https://developer.apple.com/library/prerelease/content/documentation/DeveloperTools/Conceptual/testing_with_xcode/chapters/07-code_coverage.html#//apple_ref/doc/uid/TP40014132-CH15-SW1" target="_blank" rel="noopener">Apple’s documentation</a> says: <em>Code coverage data collection incurs a performance penalty … affect[ing] execution of the code in a linear fashion so performance results remain comparable from test run to test run when it is enabled. However, you should consider whether to have code coverage enabled when you are critically evaluating the performance of routines in your tests.</em></p>
<p>To enable code coverage, edit the scheme’s <em>Test</em> action and tick the <em>Code Coverage</em> box:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/CodeCoverageSwitch.png" alt="iOS Unit Testing: Setting the Code Coverage Switch"></p>
<p>Run <em>all</em> your tests (Command-U), then open the reports navigator (Command-8). Select <em>By Time</em>, select the top item in that list, then select the <em>Coverage</em> tab:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/CoverageReport1-650x189.png" alt="iOS Unit Testing: Code Coverage Report"></p>
<p>Click the disclosure triangle to see the list of functions in <em>SearchViewController.swift</em>:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/CoverageReport2-650x252.png" alt="iOS Unit Testing: Code Coverage Report"></p>
<p>Mouse over the blue Coverage bar next to <code>updateSearchResults(_:)</code> to see that coverage is 71.88%.</p>
<p>Click the arrow button for this function to open the source file, then locate the function. As you mouse over the coverage annotations in the right sidebar, sections of code highlight green or red:</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2016/12/CoverageReport4-650x436.png" alt="iOS Unit Testing: Good and Bad Code Coverage"></p>
<p>The coverage annotations show how many times a test hit each code section; sections that weren’t called are highlighted in red. As you’d expect, the for-loop ran 3 times, but nothing in the error paths was executed. To increase coverage of this function, you could duplicate <em>abbaData.json</em>, then edit it so it causes the different errors — for example, change <code>&quot;results&quot;</code> to <code>&quot;result&quot;</code> for a test that hits <code>print(&quot;Results key not found in dictionary&quot;)</code>.</p>
<h3 id="100-Coverage"><a href="#100-Coverage" class="headerlink" title="100% Coverage?"></a>100% Coverage?</h3><p>How hard should you strive for 100% code coverage? Google “100% unit test coverage”, and you’ll find a range of arguments for and against, along with debate over the very definition of “100% coverage”. Arguments-against say the last 10-15% isn’t worth the effort. Arguments-for say the last 10-15% is the most important, <em>because</em> it’s hard to test. Google “hard to unit test bad design” to find persuasive arguments that <a href="https://www.toptal.com/qa/how-to-write-testable-code-and-why-it-matters" target="_blank" rel="noopener">untestable code is a sign of deeper design problems</a>. Further contemplation might lead to the conclusion that <a href="http://qualitycoding.org/tdd-sample-archives/" target="_blank" rel="noopener">Test Driven Development</a> is the way to go.</p>
<h2 id="Where-to-Go-From-Here"><a href="#Where-to-Go-From-Here" class="headerlink" title="Where to Go From Here?"></a>Where to Go From Here?</h2><p>You now have some great tools to use in writing tests for your projects. I hope this iOS Unit Testing and UI Testing tutorial has given you the confidence to test <em>all the things</em>!</p>
<p>You can find the completed projects in this <a href="https://koenig-media.raywenderlich.com/uploads/2016/12/Finished-3.zip" target="_blank" rel="noopener">zip file</a>.</p>
<p>Here are some resources for further study:</p>
<p>If you have any questions or comments on this tutorial, please join the forum discussion below. :]</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/10/招聘一个靠谱的 iOS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/10/招聘一个靠谱的 iOS/" itemprop="url">招聘一个靠谱的 iOS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-10T22:26:00+08:00">
                2017-12-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="招聘一个靠谱的-iOS"><a href="#招聘一个靠谱的-iOS" class="headerlink" title="招聘一个靠谱的 iOS"></a><strong>招聘一个靠谱的 iOS</strong></h2><p>2017.12.10</p>
<p>原文链接：<a href="http://blog.sunnyxx.com/2015/07/04/ios-interview/" target="_blank" rel="noopener">招聘一个靠谱的 iOS</a></p>
<p>近一年内陆续面试了不少人了，从面试者到面试官的转变让我对 iOS 招聘有了更多的感受。经过了前段时间的一大波面试，我们终于找到了志同道合的小伙伴，面试也暂时告一段落了。总结下面试人过程中的感受，你也可以读到我们对简历、算法、性格、iOS 基础、底层知识的看法和一些常问的面试题。</p>
<p><span style="color:green">### 一个靠谱的简历</span></p>
<p>简历非常能反映一个人的性格和水平，相比于你在学校获得多少奖项，工作经历、项目经历、熟悉的技术等更加关键，如果还有博客和一些 Github 上的项目，好感度++，但记得在去面试前收拾下，我们真的会挨个文件 review 你的开源代码的。我们还喜欢关注一些细节，比如简历里关键字的拼写，看似无关紧要但很能反映出对自己的要求，经常见一个简历中 iOS 这三个字母的拼写就出现 IOS、iOS、ios 三种的，非常不能忍，再列举几个常见问题：</p>
<ul>
<li>iPhone -&gt; IPHONE IPhone</li>
<li>Xcode -&gt; XCode xcode</li>
<li>Objective-C -&gt; Object-C</li>
<li>JSON -&gt; Json</li>
<li>HTTP -&gt; Http</li>
</ul>
<p>还有，注意中英文间用一个半角空格隔开，排版会漂亮很多，简历承载的不仅是内容，还有细节和态度，上面这些点往往都反映着面试者的代码风格、做事的认真程度。当然，简历写的很漂亮但面聊之后发现啥都不会的也有，甚至见过来面试上来就跟我说简历是假的，就想求个面试机会这种 - -</p>
<h3 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h3><p>别迟到，别迟到，别迟到，重要的事说三遍。有变动提前通知 HR，碰到过临时有事没来，和谁都不说一声，打电话过去还要求改个时间的，这种直接拜拜。<br>面试时最好准备纸、笔、简历，可能用不上，但很能体现认真程度。有条件的话带着 Mac 和源码，手机中装好所有在简历中出现的 App。</p>
<h3 id="关于算法"><a href="#关于算法" class="headerlink" title="关于算法"></a>关于算法</h3><p>我们是实用主义，iOS 开发中很少需要自己写复杂的算法，所以不在面试考核标准中。</p>
<h3 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h3><p>这是一个重点考察项，曾经在微博上发过一个风格纠错题：</p>
<p><img src="http://ww4.sinaimg.cn/large/51530583jw1eqo0v3zgr8j20qc0f2dja.jpg" alt="image1"></p>
<p>也曾在面试时让人当场改过，槽点不少，能够有 10 处以上修改的就基本达到标准了（处女座的人在这方面表现都很优秀</p>
<p>###一个区分度很大的面试题<br>考察一个面试者基础咋样，基本上问一个 @property 就够了：</p>
<ul>
<li>@property 后面可以有哪些修饰符？</li>
<li>什么情况使用 weak 关键字，相比 assign 有什么不同？</li>
<li>怎么用 copy 关键字？</li>
<li>这个写法会出什么问题： @property (copy) NSMutableArray *array;</li>
<li>如何让自己的类用 copy 修饰符？如何重写带 copy 关键字的 setter？</li>
</ul>
<p>这一套问题区分度比较大，如果上面的问题都能回答正确，可以延伸问更深入点的：</p>
<ul>
<li>@property 的本质是什么？ivar、getter、setter 是如何生成并添加到这个类中的</li>
<li>@protocol 和 category 中如何使用 @property</li>
<li>runtime 如何实现 weak 属性</li>
</ul>
<p>每个人擅长的领域不一样，我们一般会从简历上找自己写擅长的技术聊，假如自己并不是很熟，最好别写出来或扯出来，万一面试官刚好非常精通这里就露馅了。</p>
<p>###Checklist<br>总结过些面试题，没坚持下去，后来把这些当 checklist，面试的时候实在没话聊的时候做个提醒，语言、框架、运行机制性质的：</p>
<ul>
<li>[※]@property中有哪些属性关键字？</li>
<li>[※]weak属性需要在dealloc中置nil么？</li>
<li>[※※]@synthesize和@dynamic分别有什么作用？</li>
<li>[※※※]ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？</li>
<li>[※※※]用@property声明的NSString（或NSArray，NSDictionary）经常使用copy关键字，为什么？如果改用strong关键字，可能造成什么问题？</li>
<li>[※※※]@synthesize合成实例变量的规则是什么？假如property名为foo，存在一个名为_foo的实例变量，那么还会自动合成新变量么？</li>
<li>[※※※※※]在有了自动合成属性实例变量之后，@synthesize还有哪些使用场景？</li>
<li></li>
<li>[※※]objc中向一个nil对象发送消息将会发生什么？</li>
<li>[※※※]objc中向一个对象发送消息[obj foo]和objc_msgSend()函数之间有什么关系？</li>
<li>[※※※]什么时候会报unrecognized selector的异常？</li>
<li>[※※※※]一个objc对象如何进行内存布局？（考虑有父类的情况）</li>
<li>[※※※※]一个objc对象的isa的指针指向什么？有什么作用？</li>
<li>[※※※※]下面的代码输出什么？</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@implementation <span class="type">Son</span> : <span class="type">Father</span></span><br><span class="line">- (id)<span class="keyword">init</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> <span class="keyword">init</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"%@"</span>, <span class="type">NSStringFromClass</span>([<span class="keyword">self</span> <span class="class"><span class="keyword">class</span>]));</span></span><br><span class="line"><span class="class">        <span class="title">NSLog</span>(@"%@", <span class="title">NSStringFromClass</span>([<span class="title">super</span> <span class="title">class</span>]));</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">return</span> <span class="title">self</span>;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class">@<span class="title">end</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li></li>
<li>[※※※※]runtime如何通过selector找到对应的IMP地址？（分别考虑类方法和实例方法）</li>
<li>[※※※※]使用runtime Associate方法关联的对象，需要在主对象dealloc的时候释放么？</li>
<li>[※※※※※]objc中的类方法和实例方法有什么本质区别和联系？</li>
<li>[※※※※※]_objc_msgForward函数是做什么的，直接调用它将会发生什么？</li>
<li>[※※※※※]runtime如何实现weak变量的自动置nil？</li>
<li>[※※※※※]能否向编译后得到的类中增加实例变量？能否向运行时创建的类中添加实例变量？为什么？</li>
<li></li>
<li>[※※※]runloop和线程有什么关系？</li>
<li>[※※※]runloop的mode作用是什么？</li>
<li>[※※※※]以+ scheduledTimerWithTimeInterval…的方式触发的timer，在滑动页面上的列表时，timer会暂定回调，为什么？如何解决？</li>
<li>[※※※※※]猜想runloop内部是如何实现的？</li>
<li></li>
<li>[※]objc使用什么机制管理对象内存？</li>
<li>[※※※※]ARC通过什么方式帮助开发者管理内存？</li>
<li>[※※※※]不手动指定autoreleasepool的前提下，一个autorealese对象在什么时刻释放？（比如在一个vc的viewDidLoad中创建）</li>
<li>[※※※※]BAD_ACCESS在什么情况下出现？</li>
<li>[※※※※※]苹果是如何实现autoreleasepool的？</li>
<li></li>
<li>[※※]使用block时什么情况会发生引用循环，如何解决？</li>
<li>[※※]在block内如何修改block外部变量？</li>
<li>[※※※]使用系统的某些block api（如UIView的block版本写动画时），是否也考虑引用循环问题？</li>
<li></li>
<li>[※※]GCD的队列（dispatch_queue_t）分哪两种类型？</li>
<li>[※※※※]如何用GCD同步若干个异步调用？（如根据若干个url异步加载多张图片，然后在都下载完成后合成一张整图）</li>
<li>[※※※※]dispatch_barrier_async的作用是什么？</li>
<li>[※※※※※]苹果为什么要废弃dispatch_get_current_queue？</li>
<li>[※※※※※]以下代码运行结果如何？</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="type">NSLog</span>(@<span class="string">"1"</span>);</span><br><span class="line">    dispatch_sync(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"2"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">NSLog</span>(@<span class="string">"3"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>[※※]addObserver:forKeyPath:options:context:各个参数的作用分别是什么，observer中需要实现哪个方法才能获得KVO回调？</li>
<li>[※※※]如何手动触发一个value的KVO</li>
<li>[※※※]若一个类有实例变量NSString *_foo，调用setValue:forKey:时，可以以foo还是_foo作为key？</li>
<li>[※※※※]KVC的keyPath中的集合运算符如何使用？</li>
<li>[※※※※]KVC和KVO的keyPath一定是属性么？</li>
<li>[※※※※※]如何关闭默认的KVO的默认实现，并进入自定义的KVO实现？</li>
<li>[※※※※※]apple用什么方式实现对一个对象的KVO？</li>
<li></li>
<li>[※※]IBOutlet连出来的视图属性为什么可以被设置成weak?</li>
<li>[※※※※※]IB中User Defined Runtime Attributes如何使用？</li>
<li></li>
<li>[※※※]如何调试BAD_ACCESS错误</li>
<li>[※※※]lldb（gdb）常用的调试命令？</li>
</ul>
<p>这些小题可以做为讨论的入口，根据面试者的回答再继续聊下去。其中一些题比较底层，是留给屌屌的面试者或者试探评级用的，一般情况并不是重点的考察内容。</p>
<p>###业务能力<br>毕竟平常的工作内容不是 runtime、runloop，不怎么会用到底层的黑魔法，80% 的时间都是和搭建页面、写业务逻辑、网络请求打交道。<br>要求面试者能够熟练构建 UI，我会找一个面试者做过的页面让他分析下页面结构、约束或者 frame 布局的连法和计算方法；有时也会让面试者说说 UITableView 常用的几个 delegate 和 data source 代理方法，动态 Cell 高度计算什么的；接下来，在手机里随便找一个 App 的页面，让面试者当场说说如果是他写应该用哪些 UI 组件和布局方式等。问几个问题后就能大概了解业务能力了，我们这边重度使用 IB 和 AutoLayout，假如面试者依然使用代码码 UI 也到没关系，有“从良”意愿就很好~</p>
<p>程序架构和一些设计模式如果面试者自己觉得还不错的话也会聊聊，但跪求别说 Singleton 了，用的越多对水平就越表示怀疑。对设计模式自信的我一般问一个问题，抽象工厂模式在 Cocoa SDK 中哪些类中体现？<br>架构上 MVC 还是 MVVM 还是 MVP 神马的到是可以聊聊各自的见解，反正也没有正确答案，只要别搞的太离谱就行，比如有的人说网络请求和数据库的操作最好放到 UIView 的子类里面干。</p>
<p>网络请求、数据库等各家都有成熟的封装，基本知道咋用就行。除此之外，我们还会顺带的问下除了 iOS 开发外，还会什么其他编程语言、或者熟悉哪种脚本语言和 Terminal 操作等，甚至还问问是如何翻墙- -，相信这些技能都是很重要的。</p>
<p>###性格<br>大家都是写程序的，没啥必要用奇怪的、很难的问题难为对方，更关键的还是性格，和 Team 的风格是不是和的来。一个心态良好的面试者需要有个平常心，不傲娇也不跪舔，表达要正常，经常遇到问一个问题后一两分钟一直处于沉思状态，一句话不说，交流像挤牙膏一样，很是憋屈；还有非常屌屌的，明明不懂仍然强行据理力争，镇得住面试官也罢，撞枪口上就别怪不客气了- - 。决定要不要一个人基本上聊 5 分钟就可以确定了，喜欢水到渠成的感觉，看对眼了挡都挡不住。</p>
<p>招聘告一段落，后面将会有更精彩的事情发生。最后，再次感谢大家的支持和对我的信任。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/25/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xin Jie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XinJie's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/25/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-25T13:54:50+08:00">
                2017-11-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Xin Jie" />
          <p class="site-author-name" itemprop="name">Xin Jie</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xin Jie</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
